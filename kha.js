!function(e,t){"use strict";e.kha=e.kha||{},e.kha.input=e.kha.input||{},e.kha._Color=e.kha._Color||{};var n,r={},i=function(){return x.__string_rec(this,"")},w=w||{};function a(e,t){var n=Object.create(e);for(var r in t)n[r]=t[r];return t.toString!==Object.prototype.toString&&(n.toString=t.toString),n}var s=function(){this.speedY=0,this.speedX=0,this.y=0,this.x=0,this.speedX=0,this.speedY=0};(r.Bunny=s).__name__=!0,s.prototype={x:null,y:null,speedX:null,speedY:null,__class__:s};var l=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};(r.EReg=l).__name__=!0,l.prototype={r:null,match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw new ze("EReg::matched")},__class__:l};var o=function(){this.fps=0,this.previousTime=0,this.elapsedTime=0,this.totalFrames=0,this.deltaTime=0,this.backgroundColor=-14011577,this.gravity=.5,this.bCount=0;var n=this;ue.loadEverything(function(){n.font=ue.fonts.mainfont,n.bunnyTex=ue.images.wabbit_alpha,n.bunnies=[],n.minX=0;var e=n.bunnyTex.get_width();n.maxX=800-e,n.minY=0;var t=n.bunnyTex.get_height();n.maxY=600-t,st.get().notify(At(n,n.mouseDown),null,null,null),E.addTimeTask(At(n,n.update),0,.016666666666666666),N.notifyOnRender(At(n,n.render))})};(r.Empty=o).__name__=!0,o.prototype={bunnyTex:null,font:null,bCount:null,bunnies:null,gravity:null,maxX:null,maxY:null,minX:null,minY:null,backgroundColor:null,deltaTime:null,totalFrames:null,elapsedTime:null,previousTime:null,fps:null,mouseDown:function(e,t,n){for(var r=0,i=0==e?1e4:1e3;r<i;){r++;var a=new s;a.speedX=5*Math.random(),a.speedY=5*Math.random()-2.5,this.bunnies.push(a)}this.bCount=this.bunnies.length},update:function(){for(var e=0,t=this.bunnies.length;e<t;){var n=e++,r=this.bunnies[n];r.x+=r.speedX,r.y+=r.speedY,r.speedY+=this.gravity,r.x>this.maxX?(r.speedX*=-1,r.x=this.maxX):r.x<this.minX&&(r.speedX*=-1,r.x=this.minX),r.y>this.maxY?(r.speedY*=-.8,r.y=this.maxY,.5<Math.random()&&(r.speedY-=3+4*Math.random())):r.y<this.minY&&(r.speedY=0,r.y=this.minY)}},render:function(e){var t=E.realTime();this.deltaTime=t-this.previousTime,this.elapsedTime+=this.deltaTime,1<=this.elapsedTime&&(this.fps=this.totalFrames,this.totalFrames=0,this.elapsedTime=0),this.totalFrames++,e.get_g2().begin(!0,this.backgroundColor),e.get_g2().set_color(-1);for(var n=0,r=this.bunnies;n<r.length;){var i=r[n];++n,e.get_g2().drawImage(this.bunnyTex,i.x,i.y)}e.get_g2().set_font(this.font),e.get_g2().set_fontSize(16),e.get_g2().set_color(-16777216),e.get_g2().fillRect(0,0,800,20),e.get_g2().set_color(-1),e.get_g2().drawString("bunnies: "+this.bCount+"         fps: "+this.fps,10,2),e.get_g2().end(),this.previousTime=t},__class__:o};var q=function(){};(r.HxOverrides=q).__name__=!0,q.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:var r=e.split("-");return new Date(r[0],r[1]-1,r[2],0,0,0);case 19:var i=e.split(" "),a=i[0].split("-"),s=i[1].split(":");return new Date(a[0],a[1]-1,a[2],s[0],s[1],s[2]);default:throw new ze("Invalid date format : "+e)}},q.cca=function(e,t){var n=e.charCodeAt(t);if(n==n)return n},q.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},q.remove=function(e,t){var n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)},q.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var u=function(){};(r.Main=u).__name__=!0,u.main=function(){N.init({title:"BynnyMark",width:800,height:600},function(){new o})},Math.__name__=!0;var ne=function(){};(r.Reflect=ne).__name__=!0,ne.field=function(e,t){try{return e[t]}catch(e){e instanceof ze&&e.val;return null}},ne.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)};var m=function(){};(r.Std=m).__name__=!0,m.string=function(e){return x.__string_rec(e,"")},m.parseInt=function(e){var t=parseInt(e,!e||"0"!=e[0]||"x"!=e[1]&&"X"!=e[1]?10:16);return isNaN(t)?null:t};var Y=function(){};(r.StringTools=Y).__name__=!0,Y.endsWith=function(e,t){var n=t.length,r=e.length;return n<=r&&q.substr(e,r-n,n)==t};var j=function(){};(r.Type=j).__name__=!0,j.createEnum=function(e,t,n){var r=ne.field(e,t);if(null==r)throw new ze("No such constructor "+t);if(ne.isFunction(r)){if(null==n)throw new ze("Constructor "+t+" need parameters");return r.apply(e,n)}if(null!=n&&0!=n.length)throw new ze("Constructor "+t+" does not need parameters");return r},j.getInstanceFields=function(e){var t=[];for(var n in e.prototype)t.push(n);return q.remove(t,"__class__"),q.remove(t,"__properties__"),t};var h=function(){};(r["haxe.IMap"]=h).__name__=!0;var K=function(){};(r["haxe.Log"]=K).__name__=!0,K.formatOutput=function(e,t){var n=m.string(e);if(null==t)return n;var r=t.fileName+":"+t.lineNumber;if(null!=t&&null!=t.customParams)for(var i=0,a=t.customParams;i<a.length;){var s=a[i];++i,n+=", "+m.string(s)}return r+": "+n},K.trace=function(e,t){var n=K.formatOutput(e,t);"undefined"!=typeof console&&null!=console.log&&console.log(n)};var c=function(){};(r["haxe._Unserializer.DefaultResolver"]=c).__name__=!0,c.prototype={resolveClass:function(e){return r[e]},resolveEnum:function(e){return w[e]},__class__:c};var re=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=re.DEFAULT_RESOLVER;null==t&&(t=new c,re.DEFAULT_RESOLVER=t),this.resolver=t};(r["haxe.Unserializer"]=re).__name__=!0,re.initCodes=function(){for(var e=[],t=0,n=re.BASE64.length;t<n;){var r=t++;e[re.BASE64.charCodeAt(r)]=r}return e},re.run=function(e){return new re(e).unserialize()},re.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var e=0,t=!1,n=this.pos;;){var r=this.buf.charCodeAt(this.pos);if(r!=r)break;if(45!=r){if(r<48||57<r)break;e=10*e+(r-48),this.pos++}else{if(this.pos!=n)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(43<=t&&t<58||101==t||69==t))break;this.pos++}return parseFloat(q.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new ze("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new ze("Invalid object key");var n=this.unserialize();e[t]=n}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new ze("Invalid enum format");var n=this.readDigits();if(0==n)return j.createEnum(e,t);for(var r=[];0<n--;)r.push(this.unserialize());return j.createEnum(e,t,r)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new ze("Class not found "+e);return t;case 66:var n=this.unserialize(),r=this.resolver.resolveEnum(n);if(null==r)throw new ze("Enum not found "+n);return r;case 67:var i=this.unserialize(),a=this.resolver.resolveClass(i);if(null==a)throw new ze("Class not found "+i);var s=Object.create(a.prototype);if(this.cache.push(s),s.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new ze("Invalid custom data");return s;case 77:var l=new ie;this.cache.push(l);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var o=this.unserialize();l.set(o,this.unserialize())}return this.pos++,l;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new ze("Invalid string reference");return this.scache[u];case 97:this.buf;var h=[];for(this.cache.push(h);;){var c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}if(117==c){this.pos++;var d=this.readDigits();h[h.length+d-1]=null}else h.push(this.unserialize())}return h;case 98:var f=new ae;this.cache.push(f);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var _=this.unserialize(),g=this.unserialize();null!=Ft[_]?f.setReserved(_,g):f.h[_]=g}return this.pos++,f;case 99:var m=this.unserialize(),p=this.resolver.resolveClass(m);if(null==p)throw new ze("Class not found "+m);var v=Object.create(p.prototype);return this.cache.push(v),this.unserializeObject(v),v;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var b=this.unserialize(),w=this.resolver.resolveEnum(b);if(null==w)throw new ze("Enum not found "+b);this.pos++;var x=this.readDigits(),y=w.__constructs__.slice()[x];if(null==y)throw new ze("Unknown enum index "+b+"@"+x);var k=this.unserializeEnum(w,y);return this.cache.push(k),k;case 107:return NaN;case 108:var I=new te;this.cache.push(I);for(this.buf;104!=this.buf.charCodeAt(this.pos);)I.add(this.unserialize());return this.pos++,I;case 109:return-1/0;case 110:return null;case 111:var C={};return this.cache.push(C),this.unserializeObject(C),C;case 112:return 1/0;case 113:var B=new ee;this.cache.push(B);this.buf;for(var T=this.buf.charCodeAt(this.pos++);58==T;){var W=this.readDigits(),S=this.unserialize();B.h[W]=S,T=this.buf.charCodeAt(this.pos++)}if(104!=T)throw new ze("Invalid IntMap format");return B;case 114:var A=this.readDigits();if(A<0||A>=this.cache.length)throw new ze("Invalid reference");return this.cache[A];case 115:var L=this.readDigits(),V=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<L)throw new ze("Invalid bytes length");var D=re.CODES;null==D&&(D=re.initCodes(),re.CODES=D);for(var M=this.pos,G=3&L,E=M+(L-G),F=new $(new ArrayBuffer(3*(L>>2)+(2<=G?G-1:0))),Z=0;M<E;){var N=D[V.charCodeAt(M++)],P=D[V.charCodeAt(M++)];F.b[Z++]=N<<2|P>>4;var H=D[V.charCodeAt(M++)];F.b[Z++]=P<<4|H>>2;var R=D[V.charCodeAt(M++)];F.b[Z++]=H<<6|R}if(2<=G){var U=D[V.charCodeAt(M++)],O=D[V.charCodeAt(M++)];if(F.b[Z++]=U<<2|O>>4,3==G){var X=D[V.charCodeAt(M++)];F.b[Z++]=O<<4|X>>2}}return this.pos+=L,this.cache.push(F),F;case 116:return!0;case 118:var z;return 48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(z=q.strDate(q.substr(this.buf,this.pos,19)),this.pos+=19):z=new Date(this.readFloat()),this.cache.push(z),z;case 119:var Y=this.unserialize(),j=this.resolver.resolveEnum(Y);if(null==j)throw new ze("Enum not found "+Y);var K=this.unserializeEnum(j,this.unserialize());return this.cache.push(K),K;case 120:throw ze.wrap(this.unserialize());case 121:var Q=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<Q)throw new ze("Invalid string length");var J=q.substr(this.buf,this.pos,Q);return this.pos+=Q,J=decodeURIComponent(J.split("+").join(" ")),this.scache.push(J),J;case 122:return 0}throw this.pos--,new ze("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:re};var $=function(e){this.length=e.byteLength,this.b=new Uint8Array(e),(this.b.bufferValue=e).hxBytes=this,e.bytes=this.b};(r["haxe.io.Bytes"]=$).__name__=!0,$.ofData=function(e){var t=e.hxBytes;return null!=t?t:new $(e)},$.prototype={length:null,b:null,data:null,blit:function(e,t,n,r){if(e<0||n<0||r<0||e+r>this.length||n+r>t.length)throw new ze(_.OutsideBounds);0==n&&r==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(n,n+r),e)},sub:function(e,t){if(e<0||t<0||e+t>this.length)throw new ze(_.OutsideBounds);return new $(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+t))},getInt32:function(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(e,!0)},setInt32:function(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0)},getString:function(e,t,n){if(e<0||t<0||e+t>this.length)throw new ze(_.OutsideBounds);null==n&&(n=d.UTF8);var r="",i=this.b,a=e,s=e+t;switch(n._hx_index){case 0:for(;a<s;){var l=i[a++];if(l<128){if(0==l)break;r+=String.fromCodePoint(l)}else if(l<224){var o=(63&l)<<6|127&i[a++];r+=String.fromCodePoint(o)}else if(l<240){var u=(31&l)<<12|(127&i[a++])<<6|127&i[a++];r+=String.fromCodePoint(u)}else{var h=(15&l)<<18|(127&i[a++])<<12|(127&i[a++])<<6|127&i[a++];r+=String.fromCodePoint(h)}}break;case 1:for(;a<s;){var c=i[a++]|i[a++]<<8;r+=String.fromCodePoint(c)}}return r},toString:function(){return this.getString(0,this.length)},__class__:$};var d=w["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:i},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:i}},ee=function(){this.h={}};(r["haxe.ds.IntMap"]=ee).__name__=!0,ee.__interfaces__=[h],ee.prototype={h:null,__class__:ee};var te=function(){this.length=0};(r["haxe.ds.List"]=te).__name__=!0,te.prototype={h:null,q:null,length:null,add:function(e){var t=new f(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},__class__:te};var f=function(e,t){this.item=e,this.next=t};(r["haxe.ds._List.ListNode"]=f).__name__=!0,f.prototype={item:null,next:null,__class__:f};var ie=function(){this.h={__keys__:{}}};(r["haxe.ds.ObjectMap"]=ie).__name__=!0,ie.__interfaces__=[h],ie.prototype={h:null,set:function(e,t){var n=e.__id__||(e.__id__=++ie.count);this.h[n]=t,this.h.__keys__[n]=e},__class__:ie};var ae=function(){this.h={}};(r["haxe.ds.StringMap"]=ae).__name__=!0,ae.__interfaces__=[h],ae.prototype={h:null,rh:null,setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},__class__:ae};var _=w["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:i},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:i},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:i},Custom:(n=function(e){return{_hx_index:3,e:e,__enum__:"haxe.io.Error",toString:i}},n.__params__=["e"],n)},p={};(r["haxe.io._UInt8Array.UInt8Array_Impl_"]=p).__name__=!0,p.fromBytes=function(e,t,n){return null==t&&(t=0),null==n&&(n=e.length-t),new Uint8Array(e.b.bufferValue,t,n)};var ze=function(e){Error.call(this),this.val=e,Error.captureStackTrace&&Error.captureStackTrace(this,ze)};(r["js._Boot.HaxeError"]=ze).__name__=!0,ze.wrap=function(e){return e instanceof Error?e:new ze(e)},ze.__super__=Error,ze.prototype=a(Error.prototype,{val:null,__class__:ze});var x=function(){};(r["js.Boot"]=x).__name__=!0,x.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var n=x.__nativeClassName(e);return null!=n?x.__resolveNativeClass(n):null},x.__string_rec=function(e,t){if(null==e)return"null";if(5<=t.length)return"<...>";var n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(e.__enum__){var r=w[e.__enum__],i=r.__constructs__[e._hx_index],a=r[i];if(a.__params__){t+="\t";for(var s=i+"(",l=[],o=0,u=a.__params__;o<u.length;){var h=u[o];++o,l.push(x.__string_rec(e[h],t))}return s+l.join(",")+")"}return i}if(e instanceof Array){var c="[";t+="\t";for(var d=0,f=e.length;d<f;){var _=d++;c+=(0<_?",":"")+x.__string_rec(e[_],t)}return c+="]"}var g;try{g=e.toString}catch(e){e instanceof ze&&e.val;return"???"}if(null!=g&&g!=Object.toString&&"function"==typeof g){var m=e.toString();if("[object Object]"!=m)return m}var p=null,v="{\n";t+="\t";var b=null!=e.hasOwnProperty;for(var p in e)b&&!e.hasOwnProperty(p)||"prototype"!=p&&"__class__"!=p&&"__super__"!=p&&"__interfaces__"!=p&&"__properties__"!=p&&(2!=v.length&&(v+=", \n"),v+=t+p+" : "+x.__string_rec(e[p],t));return v+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},x.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var r=0,i=n.length;r<i;){var a=n[r++];if(a==t||x.__interfLoop(a,t))return!0}return x.__interfLoop(e.__super__,t)},x.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case Mt:return"boolean"==typeof e;case Vt:return null!=e;case Dt:return"number"==typeof e;case Lt:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(x.__interfLoop(x.getClass(e),t))return!0}else if("object"==typeof t&&x.__isNativeObj(t)&&e instanceof t)return!0;return t==Gt&&null!=e.__name__||(t==Et&&null!=e.__ename__||w[e.__enum__]==t)}},x.__cast=function(e,t){if(null==e||x.__instanceof(e,t))return e;throw new ze("Cannot cast "+m.string(e)+" to "+m.string(t))},x.__nativeClassName=function(e){var t=x.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},x.__isNativeObj=function(e){return null!=x.__nativeClassName(e)},x.__resolveNativeClass=function(e){return t[e]};var g=function(){};(r["js.html._ArrayBuffer.ArrayBufferCompat"]=g).__name__=!0,g.sliceImpl=function(e,t){var n=new Uint8Array(this,e,null==t?null:t-e),r=new Uint8Array(n.byteLength);return r.set(n),r.buffer};var Q=function(){this.names=["fill","wabbit_alpha"],this.wabbit_alphaDescription={name:"wabbit_alpha",original_height:37,original_width:26,files:["wabbit_alpha.png"],type:"image"},this.wabbit_alphaName="wabbit_alpha",this.wabbit_alpha=null,this.fillDescription={name:"fill",original_height:10,original_width:10,files:["fill.png"],type:"image"},this.fillName="fill",this.fill=null};(r["kha._Assets.ImageList"]=Q).__name__=!0,Q.prototype={get:function(e){return ne.field(this,e)},fill:null,fillName:null,fillDescription:null,fillLoad:function(t,e){var n;if(null!=e)n=e;else{var r=K.trace,i={fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"fillLoad"};n=function(e){r(e,i)}}ue.loadImage("fill",function(e){t()},n,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"fillLoad"})},fillUnload:function(){this.fill.unload(),this.fill=null},wabbit_alpha:null,wabbit_alphaName:null,wabbit_alphaDescription:null,wabbit_alphaLoad:function(t,e){var n;if(null!=e)n=e;else{var r=K.trace,i={fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"wabbit_alphaLoad"};n=function(e){r(e,i)}}ue.loadImage("wabbit_alpha",function(e){t()},n,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"wabbit_alphaLoad"})},wabbit_alphaUnload:function(){this.wabbit_alpha.unload(),this.wabbit_alpha=null},names:null,__class__:Q};var J=function(){this.names=[]};(r["kha._Assets.SoundList"]=J).__name__=!0,J.prototype={get:function(e){return ne.field(this,e)},names:null,__class__:J};var se=function(){this.names=[]};(r["kha._Assets.BlobList"]=se).__name__=!0,se.prototype={get:function(e){return ne.field(this,e)},names:null,__class__:se};var le=function(){this.names=["mainfont"],this.mainfontDescription={name:"mainfont",files:["mainfont.ttf"],type:"font"},this.mainfontName="mainfont",this.mainfont=null};(r["kha._Assets.FontList"]=le).__name__=!0,le.prototype={get:function(e){return ne.field(this,e)},mainfont:null,mainfontName:null,mainfontDescription:null,mainfontLoad:function(t,e){var n;if(null!=e)n=e;else{var r=K.trace,i={fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"mainfontLoad"};n=function(e){r(e,i)}}ue.loadFont("mainfont",function(e){t()},n,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"mainfontLoad"})},mainfontUnload:function(){this.mainfont.unload(),this.mainfont=null},names:null,__class__:le};var oe=function(){this.names=[]};(r["kha._Assets.VideoList"]=oe).__name__=!0,oe.prototype={get:function(e){return ne.field(this,e)},names:null,__class__:oe};var ue=function(){};(r["kha.Assets"]=ue).__name__=!0,ue.loadEverything=function(e,t,n,r){for(var i=0,a=0,s=j.getInstanceFields(se);a<s.length;){var l=s[a];++a,Y.endsWith(l,"Load")&&(i+=1)}for(var o=0,u=j.getInstanceFields(Q);o<u.length;){var h=u[o];++o,Y.endsWith(h,"Load")&&(i+=1)}for(var c=0,d=j.getInstanceFields(J);c<d.length;){var f=d[c];++c,Y.endsWith(f,"Load")&&(i+=1)}for(var _=0,g=j.getInstanceFields(le);_<g.length;){var m=g[_];++_,Y.endsWith(m,"Load")&&(i+=1)}for(var p=0,v=j.getInstanceFields(oe);p<v.length;){var b=v[p];++p,Y.endsWith(b,"Load")&&(i+=1)}if(0!=i){for(var w=i,x=function(){w-=1,ue.progress=1-w/i,0==w&&e()},y=0,k=j.getInstanceFields(se);y<k.length;){var I=k[y];if(++y,Y.endsWith(I,"Load")){var C=q.substr(I,0,I.length-4),B=ne.field(ue.blobs,C+"Description");null==t||t(B)?ne.field(ue.blobs,I)(x,function(e){if(null==r);x()}):x()}}for(var T=0,W=j.getInstanceFields(Q);T<W.length;){var S=W[T];if(++T,Y.endsWith(S,"Load")){var A=q.substr(S,0,S.length-4),L=ne.field(ue.images,A+"Description");null==t||t(L)?ne.field(ue.images,S)(x,function(e){if(null==r);x()}):x()}}for(var V=0,D=j.getInstanceFields(J);V<D.length;){var M=[D[V]];if(++V,Y.endsWith(M[0],"Load")){var G=q.substr(M[0],0,M[0].length-4),E=[ne.field(ue.sounds,G+"Description")];null==t||t(E[0])?ne.field(ue.sounds,M[0])(function(e,t){return function(){null==n||n(e[0])?ne.field(ue.sounds,t[0].substring(0,t[0].length-4)).uncompress(x):x()}}(E,M),null!=r?r:function(t,n){return function(e){n[0](e,t[0])}}([{fileName:"kha/Assets.hx",lineNumber:174,className:"kha.Assets",methodName:"loadEverything"}],[K.trace])):x()}}for(var F=0,Z=j.getInstanceFields(le);F<Z.length;){var N=Z[F];if(++F,Y.endsWith(N,"Load")){var P=q.substr(N,0,N.length-4),H=ne.field(ue.fonts,P+"Description");null==t||t(H)?ne.field(ue.fonts,N)(x,function(e){if(null==r);x()}):x()}}for(var R=0,U=j.getInstanceFields(oe);R<U.length;){var O=U[R];if(++R,Y.endsWith(O,"Load")){var X=q.substr(O,0,O.length-4),z=ne.field(ue.videos,X+"Description");null==t||t(z)?ne.field(ue.videos,O)(x,function(e){if(null==r);x()}):x()}}}else e()},ue.loadImage=function(t,n,e,r){var i,a=ne.field(ue.images,t+"Description");if(null!=e)i=e;else{var s=K.trace,l=r;i=function(e){s(e,l)}}D.loadImageFromDescription(a,function(e){ue.images[t]=e,n(e)},i)},ue.loadFont=function(t,n,e,r){var i,a=ne.field(ue.fonts,t+"Description");if(null!=e)i=e;else{var s=K.trace,l=r;i=function(e){s(e,l)}}D.loadFontFromDescription(a,function(e){ue.fonts[t]=e,n(e)},i)};var v=function(){};(r["kha.Canvas"]=v).__name__=!0,v.prototype={get_g4:null,get_height:null,get_width:null,__class__:v};var b=function(){};(r["kha.Resource"]=b).__name__=!0;var y=function(){};(r["kha.Image"]=y).__name__=!0,y.__interfaces__=[b,v],y.create=function(e,t,n,r){return null==n&&(n=0),null==r&&(r=0),null==H.gl?new k(e,t,n,!1):new U(e,t,n,!1,0,1)},y.fromImage=function(e,t){if(null==H.gl){var n=new k(e.width,e.height,0,!1);return n.image=e,n.createTexture(),n}var r=new U(e.width,e.height,0,!1,0,1);return r.image=e,r.createTexture(),r},y.fromBytes=function(e,t,n,r,i){if(null==r&&(r=0),null==i&&(i=0),null!=H.gl){var a=new U(t,n,r,!1,0,1);return a.image=a.bytesToArray(e),a.createTexture(),a}var s=new k(t,n,r,!1),l=s.get_g2().canvas,o=new ImageData(new Uint8ClampedArray(e.b.bufferValue),t,n);return l.putImageData(o,0,0),s},y.get_nonPow2Supported=function(){return null!=H.gl},y.prototype={unload:function(){},lock:function(e){return null==e&&(e=0),null},unlock:function(){},get_width:function(){return 0},get_height:function(){return 0},get_realWidth:function(){return 0},get_realHeight:function(){return 0},get_g4:function(){return null},__class__:y};var k=function(e,t,n,r){this.g2canvas=null,this.myWidth=e,this.myHeight=t,this.format=n,this.renderTarget=r,this.image=null,this.video=null,r&&this.createTexture()};(r["kha.CanvasImage"]=k).__name__=!0,k.init=function(){var e=window.document.createElement("canvas");null!=e&&(k.context=e.getContext("2d"),e.width=2048,e.height=2048,k.context.globalCompositeOperation="copy")},k.__super__=y,k.prototype=a(y.prototype,{image:null,video:null,data:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,g2canvas:null,get_g2:function(){if(null==this.g2canvas){var e=window.document.createElement("canvas"),t=(this.image=e).getContext("2d");e.width=this.get_width(),e.height=this.get_height(),this.g2canvas=new ft(t)}return this.g2canvas},get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},texture:null,createTexture:function(){null!=H.gl&&(this.texture=H.gl.createTexture(),H.gl.bindTexture(3553,this.texture),H.gl.texParameteri(3553,10240,9729),H.gl.texParameteri(3553,10241,9729),H.gl.texParameteri(3553,10242,33071),H.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=H.gl.createFramebuffer(),H.gl.bindFramebuffer(36160,this.frameBuffer),H.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),H.gl.bindFramebuffer(36160,null)):null!=this.video?H.gl.texImage2D(3553,0,6408,6408,5121,this.video):H.gl.texImage2D(3553,0,6408,6408,5121,this.image),H.gl.bindTexture(3553,null))},bytes:null,lock:function(e){return null==e&&(e=0),this.bytes=new $(new ArrayBuffer(0==this.format?4*this.get_width()*this.get_height():this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=H.gl){if(this.texture=H.gl.createTexture(),H.gl.bindTexture(3553,this.texture),H.gl.texParameteri(3553,10240,9729),H.gl.texParameteri(3553,10241,9729),H.gl.texParameteri(3553,10242,33071),H.gl.texParameteri(3553,10243,33071),H.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new Uint8Array(this.bytes.b.bufferValue)),1282==H.gl.getError()){for(var e=new $(new ArrayBuffer(this.get_width()*this.get_height()*4)),t=0,n=this.get_height();t<n;)for(var r=t++,i=0,a=this.get_width();i<a;){var s=i++,l=this.bytes,o=r*this.get_width()+s,u=l.b[o],h=r*this.get_width()*4+4*s;e.b[h]=u;var c=r*this.get_width()*4+4*s+1;e.b[c]=u;var d=r*this.get_width()*4+4*s+2;e.b[d]=u;var f=r*this.get_width()*4+4*s+3;e.b[f]=255}H.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new Uint8Array(e.b.bufferValue))}H.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:k});var I=e.kha._Color.Color_Impl_={};(r["kha._Color.Color_Impl_"]=I).__name__=!0,I.fromValue=function(e){return I._new(e)},I.fromBytes=function(e,t,n,r){return null==r&&(r=255),I._new(r<<24|e<<16|t<<8|n)},I.fromFloats=function(e,t,n,r){return null==r&&(r=1),I._new((255*r|0)<<24|(255*e|0)<<16|(255*t|0)<<8|255*n|0)},I.fromString=function(e){if(7!=e.length&&9!=e.length||35!=e.charCodeAt(0))throw new ze("Invalid Color string: '"+e+"'");var t=m.parseInt("0x"+q.substr(e,1,null));return 7==e.length&&(t+=-16777216),I._new(t)},I._new=function(e){return e},I.get_value=function(e){return e},I.set_value=function(e,t){return t},I.get_Rb=function(e){return(16711680&e)>>>16},I.get_Gb=function(e){return(65280&e)>>>8},I.get_Bb=function(e){return 255&e},I.get_Ab=function(e){return e>>>24},I.set_Rb=function(e,t){return e=e>>>24<<24|t<<16|(65280&e)>>>8<<8|255&e,t},I.set_Gb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|t<<8|255&e,t},I.set_Bb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|t,t},I.set_Ab=function(e,t){return e=t<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|255&e,t},I.get_R=function(e){return.00392156862745098*((16711680&e)>>>16)},I.get_G=function(e){return.00392156862745098*((65280&e)>>>8)},I.get_B=function(e){return.00392156862745098*(255&e)},I.get_A=function(e){return.00392156862745098*(e>>>24)},I.set_R=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(255*t|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t},I.set_G=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(255*t|0)<<8|.00392156862745098*(255&e)*255|0,t},I.set_B=function(e,t){return e=(.00392156862745098*(e>>>24)*255|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|255*t|0,t},I.set_A=function(e,t){return e=(255*t|0)<<24|(.00392156862745098*((16711680&e)>>>16)*255|0)<<16|(.00392156862745098*((65280&e)>>>8)*255|0)<<8|.00392156862745098*(255&e)*255|0,t};var C=function(){};(r["kha.CompilerDefines"]=C).__name__=!0;var B=function(){};(r["kha.Display"]=B).__name__=!0,B.get_primary=function(){return B.instance},B.prototype={get_frequency:function(){return 60},__class__:B};var T=function(){};(r["kha.DisplayMode"]=T).__name__=!0;var W=function(e,t,n,r,i){this.window=e,this.graphics1=t,this.graphics2=n,this.graphics4=r,this.graphics5=i};(r["kha.Framebuffer"]=W).__name__=!0,W.__interfaces__=[v],W.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,graphics5:null,init:function(e,t,n,r){this.graphics1=e,this.graphics2=t,this.graphics4=n,this.graphics5=r},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return N.windowWidth(this.window)},get_height:function(){return N.windowHeight(this.window)},__class__:W};var S=function(e,t,n,r,i,a){null==a&&(a=1),null==i&&(i=8),null==r&&(r=16),null==n&&(n=32),null==t&&(t=!0),null==e&&(e=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=e,this.verticalSync=t,this.colorBufferBits=n,this.depthBufferBits=r,this.stencilBufferBits=i,this.samplesPerPixel=a};(r["kha.FramebufferOptions"]=S).__name__=!0,S.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:S};var A=function(){};(r["kha.AlignedQuad"]=A).__name__=!0,A.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:A};var L=function(e,t,n,r,i,a,s,l){this.mySize=e,this.width=i,this.height=a,this.chars=s,this.baseline=t;for(var o=0;o<s.length;){var u=s[o];++o,u.yoff+=this.baseline}this.texture=y.create(i,a,1);for(var h=this.texture.lock(),c=0,d=0,f=a;d<f;){d++;for(var _=0,g=i;_<g;){_++;var m=l.readU8(c);h.b[c]=m,++c}}this.texture.unlock()};(r["kha.KravurImage"]=L).__name__=!0,L.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(e,t,n,r){if(t>=this.chars.length)return null;var i=1/this.width,a=1/this.height,s=this.chars[t];if(null==s)return null;var l=Math.round(n+s.xoff),o=Math.round(r+s.yoff);return e.x0=l,e.y0=o,e.x1=l+s.x1-s.x0,e.y1=o+s.y1-s.y0,e.s0=s.x0*i,e.t0=s.y0*a,e.s1=s.x1*i,e.t1=s.y1*a,e.xadvance=s.xadvance,e},__class__:L};var V=function(e){this.images=new ee,this.blob=e};(r["kha.Kravur"]=V).__name__=!0,V.__interfaces__=[b],V.prototype={oldGlyphs:null,blob:null,images:null,_get:function(e){var t=we.fontGlyphs;if(t!=this.oldGlyphs){this.oldGlyphs=t;for(var n=(L.charBlocks=[t[0]])[0]+1,r=1,i=t.length;r<i;){var a=r++;t[a]!=n?(L.charBlocks.push(t[a-1]),L.charBlocks.push(t[a]),n=t[a]+1):++n}L.charBlocks.push(t[t.length-1])}var s=1e4*e+t.length;if(this.images.h.hasOwnProperty(s))return this.images.h[s];for(var l=64,o=32,u=new Array(t.length),h=0,c=u.length;h<c;){u[h++]=new Be}for(var d=null,f=-1;f<=0;)o<l?o*=2:l*=2,d=ut.alloc(l*o),f=je.stbtt_BakeFontBitmap(this.blob,0,e,d,l,o,t,u);var _=new Te;je.stbtt_InitFont(_,this.blob,0);var g=je.stbtt_GetFontVMetrics(_),m=je.stbtt_ScaleForPixelHeight(_,e),p=Math.round(g.ascent*m),v=Math.round(g.descent*m),b=Math.round(g.lineGap*m),w=new L(0|e,p,v,b,l,o,u,d);return this.images.h[s]=w},unload:function(){this.blob=null,this.images=null},__class__:V};var D=function(){};(r["kha.LoaderImpl"]=D).__name__=!0,D.loadImageFromDescription=function(t,r,n){var i=Object.prototype.hasOwnProperty.call(t,"readable")&&t.readable;if(Y.endsWith(t.files[0],".hdr"))D.loadBlobFromDescription(t,function(e){var t=ht.parse(e.toBytes()),n=y.fromBytes($.ofData(t.data.buffer),t.width,t.height,2,i?1:0);r(n)},n);else{var a=window.document.createElement("img");a.onerror=function(e){n({url:t.files[0],error:e})},a.onload=function(e){var t=y.fromImage(a,i);r(t)},a.src=t.files[0],a.crossOrigin=""}},D.loadRemote=function(l,o,u){var h=new XMLHttpRequest;h.open("GET",l.files[0],!0),h.responseType="arraybuffer",h.onreadystatechange=function(){if(4==h.readyState)if(200<=h.status&&h.status<400||0==h.status&&""==h.statusText){var e=null,t=h.response;if(null!=t){var n=new Uint8Array(t);e=$.ofData(n)}else{if(null==h.responseBody)return void u({url:l.files[0]});var r=VBArray(h.responseBody).toArray();e=new $(new ArrayBuffer(r.length));for(var i=0,a=r.length;i<a;){var s=i++;e.b[s]=r[s]}}o(new ut(e))}else u({url:l.files[0]})},h.send(null)},D.loadBlobFromDescription=function(e,t,n){D.loadRemote(e,t,n)},D.loadFontFromDescription=function(e,t,n){D.loadBlobFromDescription(e,function(e){t(new V(e))},n)};var M=function(){};(r["kha.TimeTask"]=M).__name__=!0,M.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:M};var G=function(e,t,n){this.task=e,this.priority=t,this.id=n,this.active=!0,this.paused=!1};(r["kha.FrameTask"]=G).__name__=!0,G.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:G};var E=function(){};(r["kha.Scheduler"]=E).__name__=!0,E.init=function(){E.deltas=[];for(var e=0,t=E.DIF_COUNT;e<t;){var n=e++;E.deltas[n]=0}E.stopped=!0,E.frame_tasks_sorted=!0,E.current=E.lastTime=E.realTime(),E.currentFrameTaskId=0,E.currentTimeTaskId=0,E.currentGroupId=0,E.timeTasks=[],E.pausedTimeTasks=[],E.outdatedTimeTasks=[],E.timeTasksScratchpad=[],E.frameTasks=[],E.toDeleteFrame=[]},E.start=function(e){null==e&&(e=!1),E.vsync=O.get(0).get_vSynced();var t=B.get_primary().get_frequency();57<=t&&t<=63&&(t=60),E.onedifhz=1/t,E.stopped=!1,E.resetTime(),E.lastTime=E.realTime()-E.startTime;for(var n=0,r=E.DIF_COUNT;n<r;){var i=n++;E.deltas[i]=0}if(e){for(var a=0,s=E.timeTasks;a<s.length;){var l=s[a];++a,l.paused=!1}for(var o=0,u=E.frameTasks;o<u.length;){var h=u[o];++o,h.paused=!1}}},E.executeFrame=function(){var e=E.realTime()-E.startTime-E.lastTime,t=E.current;if(0<=e){if(null==Wt.the())if(e>E.maxframetime)E.startTime+=e-E.maxframetime,t+=e=E.maxframetime;else if(E.vsync){for(var n=E.onedifhz;n<e-E.onedifhz;)n+=E.onedifhz;e=n;for(var r=0,i=E.DIF_COUNT-2;r<i;){var a=r++;e+=E.deltas[a],E.deltas[a]=E.deltas[a+1]}e+=E.deltas[E.DIF_COUNT-2],e/=E.DIF_COUNT,E.deltas[E.DIF_COUNT-2]=n,t+=e}else{for(var s=0,l=E.DIF_COUNT-1;s<l;){var o=s++;E.deltas[o]=E.deltas[o+1]}E.deltas[E.DIF_COUNT-1]=e;for(var u=0,h=0,c=E.DIF_COUNT;h<c;){var d=h++;u+=E.deltas[d]}t+=u/=E.DIF_COUNT}else t+=e;E.lastTime=t,E.stopped||(E.current=t);for(var f=0,_=E.pausedTimeTasks;f<_.length;){var g=_[f];++f,g.next+=e}if(E.stopped)for(var m=0,p=E.timeTasks;m<p.length;){var v=p[m];++m,v.next+=e}E.executeTimeTasks(t);for(var b=0,w=E.outdatedTimeTasks;b<w.length;){var x=w[b];++b,x.next<t-10&&E.timeTasksScratchpad.push(x)}for(var y=0,k=E.timeTasksScratchpad;y<k.length;){var I=k[y];++y,q.remove(E.outdatedTimeTasks,I)}for(;0<E.timeTasksScratchpad.length;)q.remove(E.timeTasksScratchpad,E.timeTasksScratchpad[0])}E.sortFrameTasks();for(var C=0,B=E.frameTasks;C<B.length;){var T=B[C];++C,E.stopped||T.paused||!T.active||T.task()||(T.active=!1)}for(var W=0,S=E.frameTasks;W<S.length;){var A=S[W];++W,A.active||E.toDeleteFrame.push(A)}for(;0<E.toDeleteFrame.length;)q.remove(E.frameTasks,E.toDeleteFrame.pop())},E.executeTimeTasks=function(e){for(;0<E.timeTasks.length&&(E.activeTimeTask=E.timeTasks[0],E.activeTimeTask.next<=e);)E.activeTimeTask.next+=E.activeTimeTask.period,q.remove(E.timeTasks,E.activeTimeTask),E.activeTimeTask.active&&E.activeTimeTask.task()?0<E.activeTimeTask.period&&(0==E.activeTimeTask.duration||E.activeTimeTask.duration>=E.activeTimeTask.start+E.activeTimeTask.next)?E.insertSorted(E.timeTasks,E.activeTimeTask):E.archiveTimeTask(E.activeTimeTask,e):(E.activeTimeTask.active=!1,E.archiveTimeTask(E.activeTimeTask,e));E.activeTimeTask=null},E.archiveTimeTask=function(e,t){},E.realTime=function(){return N.get_time()},E.resetTime=function(){var e=N.get_time(),t=e-E.startTime;E.startTime=e;for(var n=0,r=E.timeTasks;n<r.length;){var i=r[n];++n,i.start-=t,i.next-=t}for(var a=0,s=E.DIF_COUNT;a<s;){var l=a++;E.deltas[l]=0}E.current=0,E.lastTime=0},E.addBreakableTimeTaskToGroup=function(e,t,n,r,i){null==i&&(i=0),null==r&&(r=0);var a=new M;return a.active=!0,a.task=t,a.id=++E.currentTimeTaskId,a.groupId=e,a.start=E.current+n,(a.period=0)!=r&&(a.period=r),(a.duration=0)!=i&&(a.duration=a.start+i),a.next=a.start,E.insertSorted(E.timeTasks,a),a.id},E.addTimeTaskToGroup=function(e,t,n,r,i){return null==i&&(i=0),null==r&&(r=0),E.addBreakableTimeTaskToGroup(e,function(){return t(),!0},n,r,i)},E.addTimeTask=function(e,t,n,r){return null==r&&(r=0),null==n&&(n=0),E.addTimeTaskToGroup(0,e,t,n,r)},E.insertSorted=function(e,t){for(var n=0,r=e.length;n<r;){var i=n++;if(e[i].next>t.next)return void e.splice(i,0,t)}e.push(t)},E.sortFrameTasks=function(){E.frame_tasks_sorted||(E.frameTasks.sort(function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0}),E.frame_tasks_sorted=!0)};w["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:i},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:i},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:i},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:i}};var he=function(){};(r["kha.Shaders"]=he).__name__=!0,he.init=function(){var e=[],t=ne.field(he,"painter_colored_fragData0"),n=re.run(t);e.push(ut.fromBytes(n));var r=ne.field(he,"painter_colored_fragData1"),i=re.run(r);e.push(ut.fromBytes(i));var a=ne.field(he,"painter_colored_fragData2"),s=re.run(a);e.push(ut.fromBytes(s)),he.painter_colored_frag=new Me(e,["painter-colored.frag.essl","painter-colored-webgl2.frag.essl","painter-colored-relaxed.frag.essl"]);var l=[],o=ne.field(he,"painter_colored_vertData0"),u=re.run(o);l.push(ut.fromBytes(u));var h=ne.field(he,"painter_colored_vertData1"),c=re.run(h);l.push(ut.fromBytes(c));var d=ne.field(he,"painter_colored_vertData2"),f=re.run(d);l.push(ut.fromBytes(f)),he.painter_colored_vert=new et(l,["painter-colored.vert.essl","painter-colored-webgl2.vert.essl","painter-colored-relaxed.vert.essl"]);var _=[],g=ne.field(he,"painter_image_fragData0"),m=re.run(g);_.push(ut.fromBytes(m));var p=ne.field(he,"painter_image_fragData1"),v=re.run(p);_.push(ut.fromBytes(v));var b=ne.field(he,"painter_image_fragData2"),w=re.run(b);_.push(ut.fromBytes(w)),he.painter_image_frag=new Me(_,["painter-image.frag.essl","painter-image-webgl2.frag.essl","painter-image-relaxed.frag.essl"]);var x=[],y=ne.field(he,"painter_image_vertData0"),k=re.run(y);x.push(ut.fromBytes(k));var I=ne.field(he,"painter_image_vertData1"),C=re.run(I);x.push(ut.fromBytes(C));var B=ne.field(he,"painter_image_vertData2"),T=re.run(B);x.push(ut.fromBytes(T)),he.painter_image_vert=new et(x,["painter-image.vert.essl","painter-image-webgl2.vert.essl","painter-image-relaxed.vert.essl"]);var W=[],S=ne.field(he,"painter_text_fragData0"),A=re.run(S);W.push(ut.fromBytes(A));var L=ne.field(he,"painter_text_fragData1"),V=re.run(L);W.push(ut.fromBytes(V));var D=ne.field(he,"painter_text_fragData2"),M=re.run(D);W.push(ut.fromBytes(M)),he.painter_text_frag=new Me(W,["painter-text.frag.essl","painter-text-webgl2.frag.essl","painter-text-relaxed.frag.essl"]);var G=[],E=ne.field(he,"painter_text_vertData0"),F=re.run(E);G.push(ut.fromBytes(F));var Z=ne.field(he,"painter_text_vertData1"),N=re.run(Z);G.push(ut.fromBytes(N));var P=ne.field(he,"painter_text_vertData2"),H=re.run(P);G.push(ut.fromBytes(H)),he.painter_text_vert=new et(G,["painter-text.vert.essl","painter-text-webgl2.vert.essl","painter-text-relaxed.vert.essl"]);var R=[],U=ne.field(he,"painter_video_fragData0"),O=re.run(U);R.push(ut.fromBytes(O));var X=ne.field(he,"painter_video_fragData1"),z=re.run(X);R.push(ut.fromBytes(z));var Y=ne.field(he,"painter_video_fragData2"),j=re.run(Y);R.push(ut.fromBytes(j)),he.painter_video_frag=new Me(R,["painter-video.frag.essl","painter-video-webgl2.frag.essl","painter-video-relaxed.frag.essl"]);var K=[],Q=ne.field(he,"painter_video_vertData0"),J=re.run(Q);K.push(ut.fromBytes(J));var q=ne.field(he,"painter_video_vertData1"),$=re.run(q);K.push(ut.fromBytes($));var ee=ne.field(he,"painter_video_vertData2"),te=re.run(ee);K.push(ut.fromBytes(te)),he.painter_video_vert=new et(K,["painter-video.vert.essl","painter-video-webgl2.vert.essl","painter-video-relaxed.vert.essl"])};var F=function(){};(r["kha.Sound"]=F).__name__=!0,F.__interfaces__=[b],F.prototype={compressedData:null,uncompressedData:null,uncompress:function(e){},__class__:F};var Z=function(e,t,n,r,i){null==n&&(n=-1),null==t&&(t=-1),null==e&&(e="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=e,this.window=null==r?new X(null,null,null,null,null,null,null,null,null):r,0<t?(this.window.width=t,this.width=t):this.width=this.window.width,0<n?(this.window.height=n,this.height=n):this.height=this.window.height,null==this.window.title&&(this.window.title=e),this.framebuffer=null==i?new S(null,null,null,null,null,null):i};(r["kha.SystemOptions"]=Z).__name__=!0,Z.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:Z};var N=function(){};(r["kha.System"]=N).__name__=!0,N.init=function(e,t){var n=0;e.resizable&&(n|=1),e.maximizable&&(n|=4),e.minimizable&&(n|=2);var r=new Z(e.title,e.width,e.height,new X(null,null,null,null,null,null,null,n,e.windowMode),new S(null,e.vSync,null,null,null,e.samplesPerPixel));N.start(r,function(e){t()})},N.start=function(e,t){N.theTitle=e.title,H.init(e,t)},N.notifyOnRender=function(t,n){null==n&&(n=0),N.renderListeners.push(function(e){n<e.length&&t(e[n])})},N.render=function(e){for(var t=0,n=N.renderListeners;t<n.length;){var r=n[t];++t,r(e)}},N.foreground=function(){for(var e=0,t=N.foregroundListeners;e<t.length;){var n=t[e];++e,n()}},N.background=function(){for(var e=0,t=N.backgroundListeners;e<t.length;){var n=t[e];++e,n()}},N.shutdown=function(){for(var e=0,t=N.shutdownListeners;e<t.length;){var n=t[e];++e,n()}},N.get_time=function(){return H.getTime()},N.windowWidth=function(e){return null==e&&(e=0),O.get(e).get_width()},N.windowHeight=function(e){return null==e&&(e=0),O.get_all()[e].get_height()};var P=function(){this.axes=[],this.buttons=[]};(r["kha.GamepadStates"]=P).__name__=!0,P.prototype={axes:null,buttons:null,__class__:P};var H=function(){};(r["kha.SystemImpl"]=H).__name__=!0,H.init=function(e,t){H.options=e,H.mobile=H.isMobile(),H.ios=H.isIOS(),H.chrome=H.isChrome(),H.firefox=H.isFirefox(),H.ie=H.isIE(),H.mobile||H.chrome?H.mobileAudioPlaying=!1:H.mobileAudioPlaying=!0,H.initSecondStep(t)},H.initSecondStep=function(e){H.init2(H.options.window.width,H.options.window.height),e(H.window)},H.isMobile=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("Android")||0<=e.indexOf("webOS")||0<=e.indexOf("BlackBerry")||0<=e.indexOf("Windows Phone")||!!H.isIOS()},H.isIOS=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("iPhone")||0<=e.indexOf("iPad")||0<=e.indexOf("iPod")},H.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")},H.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")},H.isIE=function(){var e=window.navigator.userAgent;return 0<=e.indexOf("MSIE ")||0<=e.indexOf("Trident/")},H.setCanvas=function(e){H.khanvas=e},H.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},H.init2=function(e,t,n){if(H.keyboard=new at,H.mouse=new lt,H.surface=new ot,H.gamepads=[],H.gamepadStates=[],H.gamepads[0]=new rt(0),H.gamepadStates[0]=new P,H.gamepads[1]=new rt(1),H.gamepadStates[1]=new P,H.gamepads[2]=new rt(2),H.gamepadStates[2]=new P,H.gamepads[3]=new rt(3),H.gamepadStates[3]=new P,window.addEventListener("gamepadconnected",function(e){rt.sendConnectEvent(e.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(e){rt.sendDisconnectEvent(e.gamepad.index)}),H.ie){H.pressedKeys=[];for(var r=0;r<256;){r++;H.pressedKeys.push(!1)}for(var i=0;i<256;){i++;H.pressedKeys.push(null)}}var a=window.document;if(a.addEventListener("copy",function(e){if(null!=N.copyListener){var t=N.copyListener();null!=t&&e.clipboardData.setData("text/plain",t),e.preventDefault()}}),a.addEventListener("cut",function(e){if(null!=N.cutListener){var t=N.cutListener();null!=t&&e.clipboardData.setData("text/plain",t),e.preventDefault()}}),a.addEventListener("paste",function(e){if(null!=N.pasteListener){var t=e.clipboardData.getData("text/plain");N.pasteListener(t),e.preventDefault()}}),H.firefox){var s=H.getCanvasElement();s.addEventListener("keydown",function(e){if((e.ctrlKey||e.metaKey)&&(67==e.keyCode||88==e.keyCode||86==e.keyCode)){var t=a.createElement("textarea"),n=function(e){a.body.removeChild(t),s.focus()};67==e.keyCode?t.oncopy=n:88==e.keyCode?t.oncut=n:86==e.keyCode&&(t.onpaste=n),a.body.appendChild(t),t.select()}})}k.init(),E.init(),H.loadFinished(e,t)},H.getMouse=function(e){return 0!=e?null:H.mouse},H.getKeyboard=function(e){return 0!=e?null:H.keyboard},H.checkGamepad=function(e){for(var t=0,n=e.axes.length;t<n;){var r=t++;if(null!=e.axes[r]){var i=e.axes[r];r%2==1&&(i=-i),H.gamepadStates[e.index].axes[r]!=i&&(H.gamepadStates[e.index].axes[r]=i,H.gamepads[e.index].sendAxisEvent(r,i))}}for(var a=0,s=e.buttons.length;a<s;){var l=a++;null!=e.buttons[l]&&H.gamepadStates[e.index].buttons[l]!=e.buttons[l].value&&(H.gamepadStates[e.index].buttons[l]=e.buttons[l].value,H.gamepads[e.index].sendButtonEvent(l,e.buttons[l].value))}e.axes.length<=4&&7<e.buttons.length&&(H.gamepadStates[e.index].axes[4]=e.buttons[6].value,H.gamepads[e.index].sendAxisEvent(4,e.buttons[6].value),H.gamepadStates[e.index].axes[5]=e.buttons[7].value,H.gamepads[e.index].sendAxisEvent(5,e.buttons[7].value))},H.getCanvasElement=function(){return null!=H.khanvas?H.khanvas:window.document.getElementById(C.canvas_id)},H.loadFinished=function(e,t){var o=H.getCanvasElement(),n=!(o.style.cursor="default");try{H.gl=o.getContext("webgl2",{alpha:!1,antialias:1<H.options.framebuffer.samplesPerPixel,stencil:!0}),H.gl.pixelStorei(37441,1),H.halfFloat={HALF_FLOAT_OES:5131},H.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},H.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},H.elementIndexUint=!0,H.gl.getExtension("EXT_color_buffer_float"),H.gl.getExtension("OES_texture_float_linear"),H.gl.getExtension("OES_texture_half_float_linear"),H.anisotropicFilter=H.gl.getExtension("EXT_texture_filter_anisotropic"),null==H.anisotropicFilter&&(H.anisotropicFilter=H.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),n=!0,H.gl2=!0,he.init()}catch(e){e instanceof ze&&e.val;K.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"kha/SystemImpl.hx",lineNumber:362,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!H.gl2)try{H.gl=o.getContext("experimental-webgl",{alpha:!1,antialias:1<H.options.framebuffer.samplesPerPixel,stencil:!0}),H.gl.pixelStorei(37441,1),H.gl.getExtension("OES_texture_float"),H.gl.getExtension("OES_texture_float_linear"),H.halfFloat=H.gl.getExtension("OES_texture_half_float"),H.gl.getExtension("OES_texture_half_float_linear"),H.depthTexture=H.gl.getExtension("WEBGL_depth_texture"),H.gl.getExtension("EXT_shader_texture_lod"),H.gl.getExtension("OES_standard_derivatives"),H.anisotropicFilter=H.gl.getExtension("EXT_texture_filter_anisotropic"),null==H.anisotropicFilter&&(H.anisotropicFilter=H.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),H.drawBuffers=H.gl.getExtension("WEBGL_draw_buffers"),H.elementIndexUint=H.gl.getExtension("OES_element_index_uint"),n=!0,he.init()}catch(e){e instanceof ze&&e.val;K.trace("Could not initialize WebGL, falling back to <canvas>.",{fileName:"kha/SystemImpl.hx",lineNumber:384,className:"kha.SystemImpl",methodName:"loadFinished"})}if(H.setCanvas(o),H.window=new O(e,t,o),n){var r=new wt;H.frame=new W(0,null,null,r),H.frame.init(new xe(H.frame),new xt(H.frame),r)}else{_t.Kravur=V,V=_t;var i=new ft(o.getContext("2d"));H.frame=new W(0,null,i,null),H.frame.init(new xe(H.frame),i,null)}!H.mobile&&ce._init()?(H._hasWebAudio=!0,de._init()):de=H.mobile?(H._hasWebAudio=!1,gt._init(),gt):(H._hasWebAudio=!1,dt),kt.instance=new It,E.start();var a=window,u=a.requestAnimationFrame;null==u&&(u=a.mozRequestAnimationFrame),null==u&&(u=a.webkitRequestAnimationFrame),null==u&&(u=a.msRequestAnimationFrame);var h=null;h=function(e){var t=window;null==u?t.setTimeout(h,16.666666666666668):u(h);var n=H.getGamepads();if(null!=n)for(var r=0,i=n.length;r<i;){var a=n[r++];null!=a&&H.checkGamepad(a)}if(E.executeFrame(),At(o,o.getContext)){var s=o.clientWidth,l=o.clientHeight;o.width==s&&o.height==l||(o.width=s,o.height=l),N.render([H.frame]),null!=H.gl&&(H.gl.clearColor(1,1,1,1),H.gl.colorMask(!1,!1,!1,!0),H.gl.clear(16384),H.gl.colorMask(!0,!0,!0,!0))}},null==u?a.setTimeout(h,16.666666666666668):u(h),o.focus(),o.onmousedown=H.mouseDown,o.onmousemove=H.mouseMove,null!=H.keyboard&&(o.onkeydown=H.keyDown,o.onkeyup=H.keyUp,o.onkeypress=H.keyPress),o.onblur=H.onBlur,o.onfocus=H.onFocus,o.onmousewheel=o.onwheel=H.mouseWheel,o.onmouseleave=H.mouseLeave,o.addEventListener("wheel mousewheel",H.mouseWheel,!1),o.addEventListener("touchstart",H.touchDown,!1),o.addEventListener("touchend",H.touchUp,!1),o.addEventListener("touchmove",H.touchMove,!1),o.addEventListener("touchcancel",H.touchCancel,!1),window.addEventListener("unload",function(){N.shutdown()})},H.lockMouse=function(){At(n=H.khanvas,n.requestPointerLock)?H.khanvas.requestPointerLock():H.khanvas.mozRequestPointerLock?H.khanvas.mozRequestPointerLock():H.khanvas.webkitRequestPointerLock&&H.khanvas.webkitRequestPointerLock()},H.unlockMouse=function(){document.exitPointerLock?document.exitPointerLock():document.mozExitPointerLock?document.mozExitPointerLock():document.webkitExitPointerLock&&document.webkitExitPointerLock()},H.canLockMouse=function(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},H.isMouseLocked=function(){return document.pointerLockElement===H.khanvas||document.mozPointerLockElement===H.khanvas||document.webkitPointerLockElement===H.khanvas},H.notifyOfMouseLockChange=function(e,t){window.document.addEventListener("pointerlockchange",e,!1),window.document.addEventListener("mozpointerlockchange",e,!1),window.document.addEventListener("webkitpointerlockchange",e,!1),window.document.addEventListener("pointerlockerror",t,!1),window.document.addEventListener("mozpointerlockerror",t,!1),window.document.addEventListener("webkitpointerlockerror",t,!1)},H.removeFromMouseLockChange=function(e,t){window.document.removeEventListener("pointerlockchange",e,!1),window.document.removeEventListener("mozpointerlockchange",e,!1),window.document.removeEventListener("webkitpointerlockchange",e,!1),window.document.removeEventListener("pointerlockerror",t,!1),window.document.removeEventListener("mozpointerlockerror",t,!1),window.document.removeEventListener("webkitpointerlockerror",t,!1)},H.setMouseXY=function(e){var t=H.khanvas.getBoundingClientRect(),n=H.khanvas.clientLeft,r=H.khanvas.clientTop;H.mouseX=(e.clientX-t.left-n)*H.khanvas.width/(t.width-2*n)|0,H.mouseY=(e.clientY-t.top-r)*H.khanvas.height/(t.height-2*r)|0},H.unlockiOSSound=function(){if(H.ios&&!H.iosSoundEnabled){var e=gt._context.createBuffer(1,1,22050),t=gt._context.createBufferSource();t.buffer=e,t.connect(gt._context.destination),t.start(),t.stop(),H.iosSoundEnabled=!0}},H.unlockSound=function(){if(!H.soundEnabled){var e=ce._context;null==e&&(e=de._context),null!=e&&e.resume().then(function(e){H.soundEnabled=!0}).catch(function(e){K.trace(e,{fileName:"kha/SystemImpl.hx",lineNumber:624,className:"kha.SystemImpl",methodName:"unlockSound"})}),ce.wakeChannels()}H.unlockiOSSound()},H.mouseLeave=function(){H.mouse.sendLeaveEvent(0)},H.mouseWheel=function(e){return H.unlockSound(),H.insideInputEvent=!0,e.preventDefault(),0==e.deltaMode?e.deltaY<0?H.mouse.sendWheelEvent(0,-1):0<e.deltaY&&H.mouse.sendWheelEvent(0,1):1==e.deltaMode&&(H.minimumScroll=0|Math.min(H.minimumScroll,Math.abs(e.deltaY)),H.mouse.sendWheelEvent(0,e.deltaY/H.minimumScroll|0)),H.insideInputEvent=!1},H.mouseDown=function(e){H.insideInputEvent=!0,H.unlockSound(),H.setMouseXY(e),1==e.which?(e.ctrlKey?(H.leftMouseCtrlDown=!0,H.mouse.sendDownEvent(0,1,H.mouseX,H.mouseY)):(H.leftMouseCtrlDown=!1,H.mouse.sendDownEvent(0,0,H.mouseX,H.mouseY)),null!=H.khanvas.setCapture?H.khanvas.setCapture():H.khanvas.ownerDocument.addEventListener("mousemove",H.documentMouseMove,!0),H.khanvas.ownerDocument.addEventListener("mouseup",H.mouseLeftUp)):2==e.which?(H.mouse.sendDownEvent(0,2,H.mouseX,H.mouseY),H.khanvas.ownerDocument.addEventListener("mouseup",H.mouseMiddleUp)):3==e.which&&(H.mouse.sendDownEvent(0,1,H.mouseX,H.mouseY),H.khanvas.ownerDocument.addEventListener("mouseup",H.mouseRightUp)),H.insideInputEvent=!1},H.mouseLeftUp=function(e){H.unlockSound(),1==e.which&&(H.insideInputEvent=!0,H.khanvas.ownerDocument.removeEventListener("mouseup",H.mouseLeftUp),null!=H.khanvas.releaseCapture?H.khanvas.ownerDocument.releaseCapture():H.khanvas.ownerDocument.removeEventListener("mousemove",H.documentMouseMove,!0),H.leftMouseCtrlDown?H.mouse.sendUpEvent(0,1,H.mouseX,H.mouseY):H.mouse.sendUpEvent(0,0,H.mouseX,H.mouseY),H.leftMouseCtrlDown=!1,H.insideInputEvent=!1)},H.mouseMiddleUp=function(e){H.unlockSound(),2==e.which&&(H.insideInputEvent=!0,H.khanvas.ownerDocument.removeEventListener("mouseup",H.mouseMiddleUp),H.mouse.sendUpEvent(0,2,H.mouseX,H.mouseY),H.insideInputEvent=!1)},H.mouseRightUp=function(e){H.unlockSound(),3==e.which&&(H.insideInputEvent=!0,H.khanvas.ownerDocument.removeEventListener("mouseup",H.mouseRightUp),H.mouse.sendUpEvent(0,1,H.mouseX,H.mouseY),H.insideInputEvent=!1)},H.documentMouseMove=function(e){e.stopPropagation(),H.mouseMove(e)},H.mouseMove=function(e){H.insideInputEvent=!0;var t=H.mouseX,n=H.mouseY;H.setMouseXY(e);var r=e.movementX,i=e.movementY;null==e.movementX&&(r=null!=e.mozMovementX?e.mozMovementX:null!=e.webkitMovementX?e.webkitMovementX:H.mouseX-t,i=null!=e.mozMovementY?e.mozMovementY:null!=e.webkitMovementY?e.webkitMovementY:H.mouseY-n),H.firefox&&(r=r*window.devicePixelRatio|0,i=i*window.devicePixelRatio|0),H.mouse.sendMoveEvent(0,H.mouseX,H.mouseY,r,i),H.insideInputEvent=!1},H.setTouchXY=function(e){var t=H.khanvas.getBoundingClientRect(),n=H.khanvas.clientLeft,r=H.khanvas.clientTop;H.touchX=(e.clientX-t.left-n)*H.khanvas.width/(t.width-2*n)|0,H.touchY=(e.clientY-t.top-r)*H.khanvas.height/(t.height-2*r)|0},H.touchDown=function(e){H.insideInputEvent=!0,H.unlockSound(),e.stopPropagation(),e.preventDefault();for(var t=0,n=e.changedTouches;t<n.length;){var r=n[t];++t;var i=r.identifier;H.ios&&(-1==(i=H.iosTouchs.indexOf(-1))&&(i=H.iosTouchs.length),H.iosTouchs[i]=r.identifier),H.setTouchXY(r),H.mouse.sendDownEvent(0,0,H.touchX,H.touchY),H.surface.sendTouchStartEvent(i,H.touchX,H.touchY)}H.insideInputEvent=!1},H.touchUp=function(e){H.insideInputEvent=!0,H.unlockSound();for(var t=0,n=e.changedTouches;t<n.length;){var r=n[t];++t;var i=r.identifier;H.ios&&(i=H.iosTouchs.indexOf(i),H.iosTouchs[i]=-1),H.setTouchXY(r),H.mouse.sendUpEvent(0,0,H.touchX,H.touchY),H.surface.sendTouchEndEvent(i,H.touchX,H.touchY)}H.insideInputEvent=!1},H.touchMove=function(e){H.insideInputEvent=!0,H.unlockSound();for(var t=0,n=0,r=e.changedTouches;n<r.length;){var i=r[n];if(++n,H.setTouchXY(i),0==t){var a=H.touchX-H.lastFirstTouchX,s=H.touchY-H.lastFirstTouchY;H.lastFirstTouchX=H.touchX,H.lastFirstTouchY=H.touchY,H.mouse.sendMoveEvent(0,H.touchX,H.touchY,a,s)}var l=i.identifier;H.ios&&(l=H.iosTouchs.indexOf(l)),H.surface.sendMoveEvent(l,H.touchX,H.touchY),++t}H.insideInputEvent=!1},H.touchCancel=function(e){H.insideInputEvent=!0,H.unlockSound();for(var t=0,n=e.changedTouches;t<n.length;){var r=n[t];++t;var i=r.identifier;H.ios&&(i=H.iosTouchs.indexOf(i)),H.setTouchXY(r),H.mouse.sendUpEvent(0,0,H.touchX,H.touchY),H.surface.sendTouchEndEvent(i,H.touchX,H.touchY)}H.iosTouchs=[],H.insideInputEvent=!1},H.onBlur=function(){N.background()},H.onFocus=function(){N.foreground()},H.keyDown=function(e){if(H.insideInputEvent=!0,H.unlockSound(),(e.keyCode<112||123<e.keyCode)&&null!=e.key&&1!=e.key.length&&e.preventDefault(),e.stopPropagation(),H.ie){if(H.pressedKeys[e.keyCode])return void e.preventDefault();H.pressedKeys[e.keyCode]=!0}else if(e.repeat)return void e.preventDefault();H.keyboard.sendDownEvent(e.keyCode),H.insideInputEvent=!1},H.keyUp=function(e){H.insideInputEvent=!0,H.unlockSound(),e.preventDefault(),e.stopPropagation(),H.ie&&(H.pressedKeys[e.keyCode]=!1),H.keyboard.sendUpEvent(e.keyCode),H.insideInputEvent=!1},H.keyPress=function(e){if(H.insideInputEvent=!0,H.unlockSound(),0!=e.which){e.preventDefault(),e.stopPropagation();var t=e.which;H.keyboard.sendPressEvent(String.fromCodePoint(t)),H.insideInputEvent=!1}},H.getGamepadId=function(e){var t=H.getGamepads();return null!=t&&t[e]?t[e].id:"unkown"},H.getGamepads=function(){return H.chrome&&kt.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null};var R=function(){};(r["kha.Video"]=R).__name__=!0,R.__interfaces__=[b],R.prototype={__class__:R};var U=function(e,t,n,r,i,a){this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=t,this.format=n,this.renderTarget=r,this.samples=a,this.image=null,this.video=null,this.depthStencilFormat=i,U.init(),r&&this.createTexture()};(r["kha.WebGLImage"]=U).__name__=!0,U.init=function(){null==U.context&&(U.canvas=window.document.createElement("canvas"),null!=U.canvas&&(U.context=U.canvas.getContext("2d"),U.canvas.width=4096,U.canvas.height=4096,U.context.globalCompositeOperation="copy"))},U.formatByteSize=function(e){switch(e){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2;default:return 4}},U.__super__=y,U.prototype=a(y.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,samples:null,frameBuffer:null,renderBuffer:null,texture:null,depthTexture:null,graphics4:null,depthStencilFormat:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new wt(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=H.gl){if(this.texture=H.gl.createTexture(),H.gl.bindTexture(3553,this.texture),H.gl.texParameteri(3553,10240,9729),H.gl.texParameteri(3553,10241,9729),H.gl.texParameteri(3553,10242,33071),H.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=H.gl.createFramebuffer(),H.gl.bindFramebuffer(36160,this.frameBuffer),this.format){case 0:H.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:H.gl.texImage2D(3553,0,H.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:H.gl.texImage2D(3553,0,H.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:H.gl.texImage2D(3553,0,H.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,H.halfFloat.HALF_FLOAT_OES,null);break;case 5:H.gl.texImage2D(3553,0,H.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,H.gl2?6403:6406,5126,null);break;case 6:H.gl.texImage2D(3553,0,H.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,H.gl2?6403:6406,H.halfFloat.HALF_FLOAT_OES,null);break;default:H.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(3==this.format){if(H.gl.texParameteri(3553,10240,9728),H.gl.texParameteri(3553,10241,9728),H.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!H.gl2){var e=H.gl.createTexture();H.gl.bindTexture(3553,e),H.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,3553,e,0),H.gl.bindTexture(3553,this.texture)}}else H.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=H.gl.checkFramebufferStatus(36160)&&K.trace("WebGL error: Framebuffer incomplete",{fileName:"kha/WebGLImage.hx",lineNumber:225,className:"kha.WebGLImage",methodName:"createTexture"}),H.gl.bindRenderbuffer(36161,null),H.gl.bindFramebuffer(36160,null)}else if(null!=this.video)H.gl.texImage2D(3553,0,6408,6408,5121,this.video);else switch(this.format){case 0:this.image instanceof Uint8Array?H.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):H.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 1:H.gl.texImage2D(3553,0,6409,this.myWidth,this.myHeight,0,6409,5121,this.image);break;case 2:H.gl.texImage2D(3553,0,H.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:H.gl.texImage2D(3553,0,H.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,H.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:H.gl.texImage2D(3553,0,H.gl2?33326:6406,this.myWidth,this.myHeight,0,H.gl2?6403:6406,5126,this.image);break;case 6:H.gl.texImage2D(3553,0,H.gl2?33325:6406,this.myWidth,this.myHeight,0,H.gl2?6403:6406,H.halfFloat.HALF_FLOAT_OES,this.image);break;default:H.gl.texImage2D(3553,0,6408,6408,5121,this.image)}H.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:null==H.depthTexture?(this.renderBuffer=H.gl.createRenderbuffer(),H.gl.bindRenderbuffer(36161,this.renderBuffer),H.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),H.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=H.gl.createTexture(),H.gl.bindTexture(3553,this.depthTexture),1==e?H.gl.texImage2D(3553,0,H.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):H.gl.texImage2D(3553,0,H.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),H.gl.texParameteri(3553,10240,9728),H.gl.texParameteri(3553,10241,9728),H.gl.texParameteri(3553,10242,33071),H.gl.texParameteri(3553,10243,33071),H.gl.bindFramebuffer(36160,this.frameBuffer),H.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==H.depthTexture?(this.renderBuffer=H.gl.createRenderbuffer(),H.gl.bindRenderbuffer(36161,this.renderBuffer),H.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),H.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=H.gl.createTexture(),H.gl.bindTexture(3553,this.depthTexture),H.gl.texImage2D(3553,0,H.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,H.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),H.gl.texParameteri(3553,10240,9728),H.gl.texParameteri(3553,10241,9728),H.gl.texParameteri(3553,10242,33071),H.gl.texParameteri(3553,10243,33071),H.gl.bindFramebuffer(36160,this.frameBuffer),H.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(e){H.gl.activeTexture(33984+e),H.gl.bindTexture(3553,this.texture),null!=this.video&&H.gl.texImage2D(3553,0,6408,6408,5121,this.video)},bytesToArray:function(e){switch(this.format){case 0:case 1:return new Uint8Array(e.b.bufferValue);case 2:case 4:case 5:case 6:return new Float32Array(e.b.bufferValue);default:return new Uint8Array(e.b.bufferValue)}},bytes:null,lock:function(e){return null==e&&(e=0),this.bytes=new $(new ArrayBuffer(U.formatByteSize(this.format)*this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=H.gl){switch(this.texture=H.gl.createTexture(),H.gl.bindTexture(3553,this.texture),H.gl.texParameteri(3553,10240,9729),H.gl.texParameteri(3553,10241,9729),H.gl.texParameteri(3553,10242,33071),H.gl.texParameteri(3553,10243,33071),this.format){case 0:H.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(H.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==H.gl.getError()){for(var e=new $(new ArrayBuffer(this.get_width()*this.get_height()*4)),t=0,n=this.get_height();t<n;)for(var r=t++,i=0,a=this.get_width();i<a;){var s=i++,l=this.bytes,o=r*this.get_width()+s,u=l.b[o],h=r*this.get_width()*4+4*s;e.b[h]=u;var c=r*this.get_width()*4+4*s+1;e.b[c]=u;var d=r*this.get_width()*4+4*s+2;e.b[d]=u;var f=r*this.get_width()*4+4*s+3;e.b[f]=255}H.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(e))}break;case 2:H.gl.texImage2D(3553,0,H.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:H.gl.texImage2D(3553,0,H.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,H.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:H.gl.texImage2D(3553,0,H.gl2?33326:6406,this.get_width(),this.get_height(),0,H.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:H.gl.texImage2D(3553,0,H.gl2?33325:6406,this.get_width(),this.get_height(),0,H.gl2?6403:6406,H.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:H.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}H.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){null!=this.texture&&H.gl.deleteTexture(this.texture),null!=this.depthTexture&&H.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&H.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&H.gl.deleteRenderbuffer(this.renderBuffer)},__class__:U});var O=function(e,t,n){this.canvas=n,this.defaultWidth=e,this.defaultHeight=t,O.windows.push(this)};(r["kha.Window"]=O).__name__=!0,O.get=function(e){return O.windows[e]},O.get_all=function(){return O.windows},O.prototype={canvas:null,defaultWidth:null,defaultHeight:null,get_width:function(){return 0==this.canvas.clientWidth?this.defaultWidth:this.canvas.clientWidth},get_height:function(){return 0==this.canvas.clientHeight?this.defaultHeight:this.canvas.clientHeight},get_vSynced:function(){return!0},__class__:O};var X=function(e,t,n,r,i,a,s,l,o){null==o&&(o=0),null==s&&(s=!0),null==i&&(i=600),null==r&&(r=800),null==n&&(n=-1),null==t&&(t=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=null,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=e,this.x=t,this.y=n,this.width=r,this.height=i,this.display=null==a?B.get_primary():a,this.visible=s,this.windowFeatures=null==l?7:l,this.mode=o};(r["kha.WindowOptions"]=X).__name__=!0,X.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:X};var z=function(){};(r["kha.audio1.AudioChannel"]=z).__name__=!0,z.prototype={__class__:z};var ce=function(){};(r["kha.audio2.Audio"]=ce).__name__=!0,ce.initContext=function(){try{return void(ce._context=new AudioContext)}catch(e){e instanceof ze&&e.val}try{return void(this._context=new webkitAudioContext)}catch(e){e instanceof ze&&e.val}},ce._init=function(){if(ce.initContext(),null==ce._context)return!1;return ce.buffer=new _e(8192,2,0|ce._context.sampleRate),ce.processingNode=ce._context.createScriptProcessor(2048,0,2),ce.processingNode.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),n=e.outputBuffer.getChannelData(1);if(null!=ce.audioCallback){ce.audioCallback(2*e.outputBuffer.length,ce.buffer);for(var r=0,i=e.outputBuffer.length;r<i;){var a=r++;t[a]=ce.buffer.data[ce.buffer.readLocation],ce.buffer.readLocation+=1,n[a]=ce.buffer.data[ce.buffer.readLocation],ce.buffer.readLocation+=1,ce.buffer.readLocation>=ce.buffer.size&&(ce.buffer.readLocation=0)}}else for(var s=0,l=e.outputBuffer.length;s<l;){var o=s++;t[o]=0,n[o]=0}},ce.processingNode.connect(ce._context.destination),!0},ce.wakeChannels=function(){H.mobileAudioPlaying=!0;for(var e=0,t=ce.virtualChannels;e<t.length;){var n=t[e];++e,n.wake()}};var de=function(){};(r["kha.audio2.Audio1"]=de).__name__=!0,de._init=function(){var e=new Array(32);de.soundChannels=e;var t=new Array(32);de.streamChannels=t;var n=new Array(32);de.internalSoundChannels=n;var r=new Array(32);de.internalStreamChannels=r;var i=new Float32Array(512);de.sampleCache1=i;var a=new Float32Array(512);de.sampleCache2=a,ce.audioCallback=de.mix},de.mix=function(e,t){if(de.sampleCache1.length<e){var n=new Float32Array(e);de.sampleCache1=n;var r=new Float32Array(e);de.sampleCache2=r}for(var i=0,a=e;i<a;){var s=i++;de.sampleCache2[s]=0}for(var l=0;l<32;){var o=l++;de.internalSoundChannels[o]=de.soundChannels[o]}for(var u=0;u<32;){var h=u++;de.internalStreamChannels[h]=de.streamChannels[h]}for(var c=0,d=de.internalSoundChannels;c<d.length;){var f=d[c];if(++c,null!=f&&!f.get_finished()){f.nextSamples(de.sampleCache1,e,t.samplesPerSecond);for(var _=0,g=e;_<g;){var m=_++;de.sampleCache2[m]+=de.sampleCache1[m]*f.get_volume()}}}for(var p=0,v=de.internalStreamChannels;p<v.length;){var b=v[p];if(++p,null!=b&&!b.get_finished()){b.nextSamples(de.sampleCache1,e,t.samplesPerSecond);for(var w=0,x=e;w<x;){var y=w++;de.sampleCache2[y]+=de.sampleCache1[y]*b.get_volume()}}}for(var k=0,I=e;k<I;){var C=k++,B=de.sampleCache2[C],T=B<1?B:1;t.data[t.writeLocation]=-1<T?T:-1,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0)}};var fe=function(e){this.looping=!1,this.stopped=!1,this.paused=!1,this.myPosition=0,this.myVolume=1,this.data=null,this.looping=e};(r["kha.audio2.AudioChannel"]=fe).__name__=!0,fe.__interfaces__=[z],fe.prototype={data:null,myVolume:null,myPosition:null,paused:null,stopped:null,looping:null,nextSamples:function(e,t,n){if(this.paused||this.stopped)for(var r=0,i=t;r<i;){e[r++]=0}else{for(var a=0;a<t;){for(var s=0,l=this.data.length-this.myPosition,o=t-a,u=l<o?l:o;s<u;){s++;e[a++]=this.data[this.myPosition++]}if(this.myPosition>=this.data.length&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;a<t;)e[a++]=0}},get_volume:function(){return this.myVolume},get_finished:function(){return this.stopped},__class__:fe};var _e=function(e,t,n){this.size=e;var r=new Float32Array(e);this.data=r,this.channels=t,this.samplesPerSecond=n,this.readLocation=0,this.writeLocation=0};(r["kha.audio2.Buffer"]=_e).__name__=!0,_e.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:_e};var ge=function(e,t){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=t};(r["kha.audio2.StreamChannel"]=ge).__name__=!0,ge.__interfaces__=[z],ge.prototype={atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(e,t,n){if(this.paused)for(var r=0,i=t;r<i;){e[r++]=0}else;},get_volume:function(){return this.myVolume},get_finished:function(){return this.atend},__class__:ge};var me=w["kha.audio2.PlayMode"]={__ename__:!0,__constructs__:["Stopped","Paused","Playing"],Stopped:{_hx_index:0,__enum__:"kha.audio2.PlayMode",toString:i},Paused:{_hx_index:1,__enum__:"kha.audio2.PlayMode",toString:i},Playing:{_hx_index:2,__enum__:"kha.audio2.PlayMode",toString:i}},pe=function(e,t){this.mode=me.Playing,this.aeChannel=e,this.looping=t,this.lastTickTime=E.realTime(),this.lastPosition=0};(r["kha.audio2.VirtualStreamChannel"]=pe).__name__=!0,pe.__interfaces__=[z],pe.prototype={aeChannel:null,mode:null,lastTickTime:null,lastPosition:null,looping:null,wake:function(){this.updatePosition(),this.aeChannel.set_position(this.lastPosition),this.aeChannel.play()},updatePosition:function(){var e=E.realTime();switch(this.mode._hx_index){case 0:this.lastPosition=0;break;case 1:break;case 2:for(this.lastPosition+=e-this.lastTickTime;this.lastPosition>this.get_length();)this.lastPosition-=this.get_length()}this.lastTickTime=e},get_length:function(){return this.aeChannel.get_length()},__class__:pe};var ve=function(){};(r["kha.audio2.ogg.vorbis.data.Header"]=ve).__name__=!0;var be=function(){};(r["kha.graphics1.Graphics"]=be).__name__=!0;var we=function(){this.transformations=[],this.transformations.push(new Ct(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(r["kha.graphics2.Graphics"]=we).__name__=!0,we.prototype={begin:function(e,t){null==e&&(e=!0)},end:function(){},drawImage:function(e,t,n){this.drawSubImage(e,t,n,0,0,e.get_width(),e.get_height())},drawSubImage:function(e,t,n,r,i,a,s){this.drawScaledSubImage(e,r,i,a,s,t,n,a,s)},drawScaledSubImage:function(e,t,n,r,i,a,s,l,o){},fillRect:function(e,t,n,r){},drawString:function(e,t,n){},set_color:function(e){return-16777216},set_font:function(e){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(e){return this.myFontSize=e},get_opacity:function(){return this.opacities[this.opacities.length-1]},pipe:null,transformations:null,opacities:null,myFontSize:null,__class__:we};var xe=function(e){this.canvas=e};(r["kha.graphics2.Graphics1"]=xe).__name__=!0,xe.__interfaces__=[be],xe.prototype={canvas:null,__class__:xe};w["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:i},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:i}};var ye=function(){};(r["kha.graphics2.truetype.VectorOfIntPointer"]=ye).__name__=!0,ye.prototype={value:null,__class__:ye};var ke=function(){};(r["kha.graphics2.truetype.Stbtt_temp_rect"]=ke).__name__=!0,ke.prototype={x0:null,y0:null,x1:null,y1:null,__class__:ke};var Ie=function(){};(r["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=Ie).__name__=!0,Ie.prototype={advanceWidth:null,leftSideBearing:null,__class__:Ie};var Ce=function(){};(r["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=Ce).__name__=!0,Ce.prototype={ascent:null,descent:null,lineGap:null,__class__:Ce};var Be=function(){};(r["kha.graphics2.truetype.Stbtt_bakedchar"]=Be).__name__=!0,Be.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:Be};var Te=function(){};(r["kha.graphics2.truetype.Stbtt_fontinfo"]=Te).__name__=!0,Te.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:Te};var Ye=function(){};(r["kha.graphics2.truetype.Stbtt_vertex"]=Ye).__name__=!0,Ye.prototype={x:null,y:null,cx:null,cy:null,type:null,__class__:Ye};var We=function(){};(r["kha.graphics2.truetype.Stbtt__bitmap"]=We).__name__=!0,We.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:We};var Se=function(){};(r["kha.graphics2.truetype.Stbtt__edge"]=Se).__name__=!0,Se.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:Se};var Ae=function(){};(r["kha.graphics2.truetype.Stbtt__active_edge"]=Ae).__name__=!0,Ae.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:Ae};var Le=function(){};(r["kha.graphics2.truetype.Stbtt__point"]=Le).__name__=!0,Le.prototype={x:null,y:null,__class__:Le};var je=function(){};(r["kha.graphics2.truetype.StbTruetype"]=je).__name__=!0,je.stbtt__find_table=function(e,t,n){for(var r=t+4,i=e.readU8(r),a=t+12,s=0,l=e.readU8(r+1)|i<<8;s<l;){var o=a+16*s++,u=q.cca(n,0),h=q.cca(n,1),c=q.cca(n,2),d=q.cca(n,3);if(e.readU8(o)==u&&e.readU8(o+1)==h&&e.readU8(o+2)==c&&e.readU8(o+3)==d){var f=o+8,_=e.readU8(f),g=e.readU8(f+1),m=e.readU8(f+2);return e.readU8(f+3)|m<<8|g<<16|_<<24}}return 0},je.stbtt_InitFont=function(e,t,n){e.data=t,e.fontstart=n;var r=je.stbtt__find_table(t,n,"cmap");if(e.loca=je.stbtt__find_table(t,n,"loca"),e.head=je.stbtt__find_table(t,n,"head"),e.glyf=je.stbtt__find_table(t,n,"glyf"),e.hhea=je.stbtt__find_table(t,n,"hhea"),e.hmtx=je.stbtt__find_table(t,n,"hmtx"),e.kern=je.stbtt__find_table(t,n,"kern"),0==r||0==e.loca||0==e.head||0==e.glyf||0==e.hhea||0==e.hmtx)return!1;var i=je.stbtt__find_table(t,n,"maxp");if(0!=i){var a=i+4,s=t.readU8(a),l=t.readU8(a+1);e.numGlyphs=l|s<<8}else e.numGlyphs=65535;for(var o=r+2,u=t.readU8(o),h=t.readU8(o+1)|u<<8,c=e.index_map=0,d=h;c<d;){var f=r+4+8*c++,_=t.readU8(f);switch(t.readU8(f+1)|_<<8){case 0:var g=f+4,m=t.readU8(g),p=t.readU8(g+1),v=t.readU8(g+2),b=t.readU8(g+3);e.index_map=r+(b|v<<8|p<<16|m<<24);break;case 3:var w=f+2,x=t.readU8(w);switch(t.readU8(w+1)|x<<8){case 1:case 10:var y=f+4,k=t.readU8(y),I=t.readU8(y+1),C=t.readU8(y+2),B=t.readU8(y+3);e.index_map=r+(B|C<<8|I<<16|k<<24)}}}if(0==e.index_map)return!1;var T=e.head+50,W=t.readU8(T),S=t.readU8(T+1);return e.indexToLocFormat=S|W<<8,!0},je.stbtt_FindGlyphIndex=function(e,t){var n=e.data,r=e.index_map,i=n.readU8(r),a=n.readU8(r+1)|i<<8;if(0==a){var s=r+2,l=n.readU8(s);return t<(n.readU8(s+1)|l<<8)-6?n.readU8(r+6+t):0}if(6==a){var o=r+6,u=n.readU8(o),h=n.readU8(o+1)|u<<8,c=r+8,d=n.readU8(c),f=n.readU8(c+1);if(h<=t&&t<h+(f|d<<8)){var _=r+10+2*(t-h),g=n.readU8(_);return n.readU8(_+1)|g<<8}return 0}if(2==a)throw new ze("Error");if(4==a){var m=r+6,p=n.readU8(m),v=(n.readU8(m+1)|p<<8)>>1,b=r+8,w=n.readU8(b),x=(n.readU8(b+1)|w<<8)>>1,y=r+10,k=n.readU8(y),I=n.readU8(y+1)|k<<8,C=r+12,B=n.readU8(C),T=(n.readU8(C+1)|B<<8)>>1,W=r+14,S=W;if(65535<t)return 0;var A=S+2*T,L=n.readU8(A);for((n.readU8(A+1)|L<<8)<=t&&(S+=2*T),S-=2;0!=I;){var V=S+2*(x>>=1),D=n.readU8(V);(n.readU8(V+1)|D<<8)<t&&(S+=2*x),--I}var M=(S+=2)-W>>1,G=W+2*M,E=n.readU8(G);if((n.readU8(G+1)|E<<8)<t)throw new ze("Error");var F=r+14+2*v+2+2*M,Z=n.readU8(F),N=n.readU8(F+1)|Z<<8;if(t<N)return 0;var P=r+14+6*v+2+2*M,H=n.readU8(P),R=n.readU8(P+1)|H<<8;if(0==R){var U=r+14+4*v+2+2*M,O=n.readU8(U),X=n.readU8(U+1)|O<<8;return t+(0!=(32768&X)?X-65536:X)}var z=R+2*(t-N)+r+14+6*v+2+2*M,Y=n.readU8(z);return n.readU8(z+1)|Y<<8}if(12!=a&&13!=a)throw new ze("Error");for(var j=r+12,K=n.readU8(j),Q=n.readU8(j+1),J=n.readU8(j+2),q=0,$=n.readU8(j+3)|J<<8|Q<<16|K<<24;q<$;){var ee=q+($-q>>1),te=r+16+12*ee,ne=n.readU8(te),re=n.readU8(te+1),ie=n.readU8(te+2),ae=n.readU8(te+3)|ie<<8|re<<16|ne<<24,se=r+16+12*ee+4,le=n.readU8(se),oe=n.readU8(se+1),ue=n.readU8(se+2),he=n.readU8(se+3);if(t<ae)$=ee;else{if(!((he|ue<<8|oe<<16|le<<24)<t)){var ce=r+16+12*ee+8,de=n.readU8(ce),fe=n.readU8(ce+1),_e=n.readU8(ce+2),ge=n.readU8(ce+3)|_e<<8|fe<<16|de<<24;return 12==a?ge+t-ae:ge}q=ee+1}}return 0},je.stbtt_setvertex=function(e,t,n,r,i,a){e.type=t,e.x=n,e.y=r,e.cx=i,e.cy=a},je.stbtt__GetGlyfOffset=function(e,t){var n,r;if(t>=e.numGlyphs)return-1;if(2<=e.indexToLocFormat)return-1;if(0==e.indexToLocFormat){var i=e.glyf,a=e.data,s=e.loca+2*t,l=a.readU8(s);n=i+2*(a.readU8(s+1)|l<<8);var o=e.glyf,u=e.data,h=e.loca+2*t+2,c=u.readU8(h);r=o+2*(u.readU8(h+1)|c<<8)}else{var d=e.glyf,f=e.data,_=e.loca+4*t,g=f.readU8(_),m=f.readU8(_+1),p=f.readU8(_+2);n=d+(f.readU8(_+3)|p<<8|m<<16|g<<24);var v=e.glyf,b=e.data,w=e.loca+4*t+4,x=b.readU8(w),y=b.readU8(w+1),k=b.readU8(w+2);r=v+(b.readU8(w+3)|k<<8|y<<16|x<<24)}return n==r?-1:n},je.stbtt_GetGlyphBox=function(e,t,n){var r=je.stbtt__GetGlyfOffset(e,t);if(r<0)return!1;var i=e.data,a=r+2,s=i.readU8(a),l=i.readU8(a+1)|s<<8;n.x0=0!=(32768&l)?l-65536:l;var o=e.data,u=r+4,h=o.readU8(u),c=o.readU8(u+1)|h<<8;n.y0=0!=(32768&c)?c-65536:c;var d=e.data,f=r+6,_=d.readU8(f),g=d.readU8(f+1)|_<<8;n.x1=0!=(32768&g)?g-65536:g;var m=e.data,p=r+8,v=m.readU8(p),b=m.readU8(p+1)|v<<8;return n.y1=0!=(32768&b)?b-65536:b,!0},je.stbtt__close_shape=function(e,t,n,r,i,a,s,l,o,u){return r?(n&&je.stbtt_setvertex(e[t++],3,o+s>>1,u+l>>1,o,u),je.stbtt_setvertex(e[t++],3,i,a,s,l)):n?je.stbtt_setvertex(e[t++],3,i,a,o,u):je.stbtt_setvertex(e[t++],2,i,a,0,0),t},je.copyVertices=function(e,t,n,r){for(var i=0,a=r;i<a;){var s=i++;t[n+s]=e[s]}},je.stbtt_GetGlyphShape=function(e,t){var n,r=e.data,i=null,a=0,s=je.stbtt__GetGlyfOffset(e,t);if(s<0)return null;var l=r.readU8(s),o=r.readU8(s+1)|l<<8,u=0!=(32768&o)?o-65536:o;if(0<u){var h,c=0,d=0,f=0,_=!1,g=!1,m=0;n=r.sub(s+10,r.get_length()-(s+10));var p=s+10+2*u,v=r.readU8(p),b=r.readU8(p+1)|v<<8,w=r.sub(s+10+2*u+2+b,r.get_length()-(s+10+2*u+2+b)),x=2*u-2,y=n.readU8(x),k=1+(n.readU8(x+1)|y<<8),I=k+2*u;if(null==(i=new Array(I)))return null;for(var C=0,B=i.length;C<B;){i[C++]=new Ye}var T=f=0;h=I-k;for(var W=0,S=k;W<S;){var A=W++;0==T?0!=(8&(c=w.readU8(m++)))&&(T=w.readU8(m++)):--T,i[h+A].type=c}for(var L=0,V=0,D=k;V<D;){var M=V++;if(0!=(2&(c=i[h+M].type))){var G=w.readU8(m++);L+=0!=(16&c)?G:-G}else if(0==(16&c)){var E=w.readU8(m),F=w.readU8(m+1)|E<<8;L+=0!=(32768&F)?F-65536:F,m+=2}i[h+M].x=L}for(var Z=0,N=0,P=k;N<P;){var H=N++;if(0!=(4&(c=i[h+H].type))){var R=w.readU8(m++);Z+=0!=(32&c)?R:-R}else if(0==(32&c)){var U=w.readU8(m),O=w.readU8(m+1)|U<<8;Z+=0!=(32768&O)?O-65536:O,m+=2}i[h+H].y=Z}for(var X=a=0,z=X,Y=z,j=Y,K=j,Q=K,J=0;J<k;){if(c=i[h+J].type,L=i[h+J].x,Z=i[h+J].y,f==J){0!=J&&(a=je.stbtt__close_shape(i,a,_,g,Q,K,z,X,j,Y)),(g=0==(1&c))?(z=L,X=Z,0==(1&i[h+J+1].type)?(Q=L+i[h+J+1].x>>1,K=Z+i[h+J+1].y>>1):(Q=i[h+J+1].x,K=i[h+J+1].y,++J)):(Q=L,K=Z),je.stbtt_setvertex(i[a++],1,Q,K,0,0),_=!1;var q=2*d,$=n.readU8(q);f=1+(n.readU8(q+1)|$<<8),++d}else _=0==(1&c)?(_&&je.stbtt_setvertex(i[a++],3,j+L>>1,Y+Z>>1,j,Y),j=L,Y=Z,!0):(_?je.stbtt_setvertex(i[a++],3,L,Z,j,Y):je.stbtt_setvertex(i[a++],2,L,Z,0,0),!1);++J}a=je.stbtt__close_shape(i,a,_,g,Q,K,z,X,j,Y)}else if(-1==u){var ee=1,te=r.sub(s+10,r.get_length()-(s+10)),ne=0;for(a=0,i=null;0!=ee;){var re,ie,ae=null,se=1,le=0,oe=0,ue=1,he=0,ce=0,de=te.readU8(ne),fe=te.readU8(ne+1)|de<<8,_e=0!=(32768&fe)?fe-65536:fe;ne+=2;var ge=te.readU8(ne),me=te.readU8(ne+1)|ge<<8,pe=0!=(32768&me)?me-65536:me;if(ne+=2,0==(2&_e))throw new ze("Error");if(0!=(1&_e)){var ve=te.readU8(ne),be=te.readU8(ne+1)|ve<<8;he=0!=(32768&be)?be-65536:be,ne+=2;var we=te.readU8(ne),xe=te.readU8(ne+1)|we<<8;ce=0!=(32768&xe)?xe-65536:xe,ne+=2}else{var ye=te.readU8(ne);he=128<=ye?ye-256:ye,++ne;var ke=te.readU8(ne);ce=128<=ke?ke-256:ke,++ne}if(0!=(8&_e)){var Ie=te.readU8(ne),Ce=te.readU8(ne+1)|Ie<<8;se=ue=(0!=(32768&Ce)?Ce-65536:Ce)/16384,ne+=2,le=oe=0}else if(0!=(64&_e)){var Be=te.readU8(ne),Te=te.readU8(ne+1)|Be<<8;se=(0!=(32768&Te)?Te-65536:Te)/16384,ne+=2,le=oe=0;var We=te.readU8(ne),Se=te.readU8(ne+1)|We<<8;ue=(0!=(32768&Se)?Se-65536:Se)/16384,ne+=2}else if(0!=(128&_e)){var Ae=te.readU8(ne),Le=te.readU8(ne+1)|Ae<<8;se=(0!=(32768&Le)?Le-65536:Le)/16384,ne+=2;var Ve=te.readU8(ne),De=te.readU8(ne+1)|Ve<<8;le=(0!=(32768&De)?De-65536:De)/16384,ne+=2;var Me=te.readU8(ne),Ge=te.readU8(ne+1)|Me<<8;oe=(0!=(32768&Ge)?Ge-65536:Ge)/16384,ne+=2;var Ee=te.readU8(ne),Fe=te.readU8(ne+1)|Ee<<8;ue=(0!=(32768&Fe)?Fe-65536:Fe)/16384,ne+=2}var Ze=Math.sqrt(se*se+le*le),Ne=Math.sqrt(oe*oe+ue*ue);if(0<(re=null==(ie=je.stbtt_GetGlyphShape(e,pe))?0:ie.length)){for(var Pe=0,He=re;Pe<He;){var Re=ie[Pe++],Ue=Re.x,Oe=Re.y;Re.x=Ze*(se*Ue+oe*Oe+he)|0,Re.y=Ne*(le*Ue+ue*Oe+ce)|0,Ue=Re.cx,Oe=Re.cy,Re.cx=Ze*(se*Ue+oe*Oe+he)|0,Re.cy=Ne*(le*Ue+ue*Oe+ce)|0}if(null==(ae=new Array(a+re)))return null;0<a&&je.copyVertices(i,ae,0,a),je.copyVertices(ie,ae,a,re),i=ae,a+=re}ee=32&_e}}else if(u<0)throw new ze("Error");if(null==i)return null;if(i.length<a)throw new ze("Error");if(a<i.length){var Xe=new Array(a);return je.copyVertices(i,Xe,0,a),Xe}return i},je.stbtt_GetGlyphHMetrics=function(e,t){var n=e.data,r=e.hhea+34,i=n.readU8(r),a=n.readU8(r+1)|i<<8,s=new Ie;if(t<a){var l=e.data,o=e.hmtx+4*t,u=l.readU8(o),h=l.readU8(o+1)|u<<8;s.advanceWidth=0!=(32768&h)?h-65536:h;var c=e.data,d=e.hmtx+4*t+2,f=c.readU8(d),_=c.readU8(d+1)|f<<8;s.leftSideBearing=0!=(32768&_)?_-65536:_}else{var g=e.data,m=e.hmtx+4*(a-1),p=g.readU8(m),v=g.readU8(m+1)|p<<8;s.advanceWidth=0!=(32768&v)?v-65536:v;var b=e.data,w=e.hmtx+4*a+2*(t-a),x=b.readU8(w),y=b.readU8(w+1)|x<<8;s.leftSideBearing=0!=(32768&y)?y-65536:y}return s},je.stbtt_GetFontVMetrics=function(e){var t=new Ce,n=e.data,r=e.hhea+4,i=n.readU8(r),a=n.readU8(r+1)|i<<8;t.ascent=0!=(32768&a)?a-65536:a;var s=e.data,l=e.hhea+6,o=s.readU8(l),u=s.readU8(l+1)|o<<8;t.descent=0!=(32768&u)?u-65536:u;var h=e.data,c=e.hhea+8,d=h.readU8(c),f=h.readU8(c+1)|d<<8;return t.lineGap=0!=(32768&f)?f-65536:f,t},je.stbtt_ScaleForPixelHeight=function(e,t){var n=e.data,r=e.hhea+4,i=n.readU8(r),a=n.readU8(r+1)|i<<8,s=e.data,l=e.hhea+6,o=s.readU8(l),u=s.readU8(l+1)|o<<8;return t/((0!=(32768&a)?a-65536:a)-(0!=(32768&u)?u-65536:u))},je.stbtt_GetGlyphBitmapBoxSubpixel=function(e,t,n,r,i,a){var s=new ke;if(je.stbtt_GetGlyphBox(e,t,s)){var l=s.x0,o=s.x1,u=s.y0,h=s.y1;s.x0=Math.floor(l*n+i),s.y0=Math.floor(-h*r+a),s.x1=Math.ceil(o*n+i),s.y1=Math.ceil(-u*r+a)}else s.x0=0,s.y0=0,s.x1=0,s.y1=0;return s},je.stbtt_GetGlyphBitmapBox=function(e,t,n,r){return je.stbtt_GetGlyphBitmapBoxSubpixel(e,t,n,r,0,0)},je.stbtt__new_active=function(e,t,n,r){var i=new Ae,a=(e[t].x1-e[t].x0)/(e[t].y1-e[t].y0);return null==i||(i.fdx=a,i.fdy=0!=a?1/a:0,i.fx=e[t].x0+a*(r-e[t].y0),i.fx-=n,i.direction=e[t].invert?1:-1,i.sy=e[t].y0,i.ey=e[t].y1,i.next=null),i},je.stbtt__handle_clipped_edge=function(e,t,n,r,i,a,s,l){if(a!=l){if(!(a<l))throw new ze("Error");if(!(r.sy<=r.ey))throw new ze("Error");if(!(a>r.ey||l<r.sy)){if(a<r.sy&&(i+=(s-i)*(r.sy-a)/(l-a),a=r.sy),l>r.ey&&(s+=(s-i)*(r.ey-l)/(l-a),l=r.ey),i==n){if(!(s<=n+1))throw new ze("Error")}else if(i==n+1){if(!(n<=s))throw new ze("Error")}else if(i<=n){if(!(s<=n))throw new ze("Error")}else if(n+1<=i){if(!(n+1<=s))throw new ze("Error")}else if(!(n<=s&&s<=n+1))throw new ze("Error");if(i<=n&&s<=n){var o=t+n,u=e;u[o]=u[o]+r.direction*(l-a)}else if(!(n+1<=i&&n+1<=s)){if(!(n<=i&&i<=n+1&&n<=s&&s<=n+1))throw new ze("Error");var h=t+n,c=e;c[h]=c[h]+r.direction*(l-a)*(1-(i-n+(s-n))/2)}}}},je.stbtt__fill_active_edges_new=function(e,t,n,r,i,a){for(var s=a+1;null!=i;){if(!(i.ey>=a))throw new ze("Error");if(0==i.fdx){var l=i.fx;l<r&&(0<=l?(je.stbtt__handle_clipped_edge(e,0,0|l,i,l,a,l,s),je.stbtt__handle_clipped_edge(t,n-1,l+1|0,i,l,a,l,s)):je.stbtt__handle_clipped_edge(t,n-1,0,i,l,a,l,s))}else{var o,u,h,c,d=i.fx,f=i.fdx,_=d+f,g=i.fdy;if(!(i.sy<=s&&i.ey>=a))throw new ze("Error");if(h=i.sy>a?(o=d+f*(i.sy-a),i.sy):(o=d,a),c=i.ey<s?(u=d+f*(i.ey-a),i.ey):(u=_,s),0<=o&&0<=u&&o<r&&u<r)if((0|o)==(0|u)){var m=0|o,p=c-h;if(!(0<=m&&m<r))throw new ze("Error");var v=m,b=e;b[v]=b[v]+i.direction*(1-(o-m+(u-m))/2)*p;var w=n+m,x=t;x[w]=x[w]+i.direction*p}else{if(u<o){var y=h=s-(h-a);h=c=s-(c-a),c=y,y=u,u=o,o=y,f=-f,g=-g,y=d,d=_,_=y}var k=0|o,I=0|u,C=(k+1-d)*g+a,B=i.direction,T=B*(C-h),W=k,S=e;S[W]=S[W]+T*(1-(o-k+(k+1-k))/2);for(var A=B*g,L=k+1,V=I;L<V;){var D=L++,M=e;M[D]=M[D]+(T+A/2),T+=A}if(C+=g*(I-(k+1)),!(Math.abs(T)<=1.01))throw new ze("Error");var G=I,E=e;E[G]=E[G]+(T+B*(1-(I-I+(u-I))/2)*(c-C));var F=n+I,Z=t;Z[F]=Z[F]+B*(c-h)}else for(var N=0,P=r;N<P;){var H=N++,R=a,U=H,O=H+1,X=_,z=s,Y=(H-d)/f+a,j=(H+1-d)/f+a;d<U&&O<X?(je.stbtt__handle_clipped_edge(e,0,H,i,d,R,U,Y),je.stbtt__handle_clipped_edge(e,0,H,i,U,Y,O,j),je.stbtt__handle_clipped_edge(e,0,H,i,O,j,X,z)):X<U&&O<d?(je.stbtt__handle_clipped_edge(e,0,H,i,d,R,O,j),je.stbtt__handle_clipped_edge(e,0,H,i,O,j,U,Y),je.stbtt__handle_clipped_edge(e,0,H,i,U,Y,X,z)):d<U&&U<X?(je.stbtt__handle_clipped_edge(e,0,H,i,d,R,U,Y),je.stbtt__handle_clipped_edge(e,0,H,i,U,Y,X,z)):X<U&&U<d?(je.stbtt__handle_clipped_edge(e,0,H,i,d,R,U,Y),je.stbtt__handle_clipped_edge(e,0,H,i,U,Y,X,z)):d<O&&O<X?(je.stbtt__handle_clipped_edge(e,0,H,i,d,R,O,j),je.stbtt__handle_clipped_edge(e,0,H,i,O,j,X,z)):X<O&&O<d?(je.stbtt__handle_clipped_edge(e,0,H,i,d,R,O,j),je.stbtt__handle_clipped_edge(e,0,H,i,O,j,X,z)):je.stbtt__handle_clipped_edge(e,0,H,i,d,R,X,z)}}i=i.next}},je.stbtt__rasterize_sorted_edges=function(e,t,n,r,i,a){var s,l,o=null,u=0,h=0;64<e.w?s=new Array(2*e.w+1):s=new Array(129);var c=s;l=e.w;var d=a;for(t[h+n].y0=a+e.h+1;u<e.h;){for(var f=d+0,_=d+1,g=o,m=null,p=0,v=e.w;p<v;){s[p++]=0}for(var b=0,w=e.w+1;b<w;){c[l+b++]=0}for(;null!=g;){var x=g;if(x.ey<=f){if(g=(null==m?o=x.next:m.next=x.next,x.next),0==x.direction)throw new ze("Error");x.direction=0}else g=(m=g).next}for(;t[h].y0<=_;){if(t[h].y0!=t[h].y1){var y=je.stbtt__new_active(t,h,i,f);if(!(y.ey>=f))throw new ze("Error");y.next=o,o=y}++h}null!=o&&je.stbtt__fill_active_edges_new(s,c,l+1,e.w,o,f);for(var k=0,I=0,C=e.w;I<C;){var B=I++;k+=c[l+B];var T=s[B]+k,W=0|(T=255*Math.abs(T)+.5);255<W&&(W=255),e.pixels.writeU8(e.pixels_offset+u*e.stride+B,W)}for(m=null,g=o;null!=g;){var S=g;S.fx+=S.fdx,g=(m=g).next}++d,++u}},je.STBTT__COMPARE=function(e,t){return e.y0<t.y0},je.stbtt__sort_edges_ins_sort=function(e,t){for(var n,r=1,i=t;r<i;){var a=r++,s=e[a],l=s;for(n=a;0<n;){var o=e[n-1];if(!je.STBTT__COMPARE(l,o))break;e[n]=e[n-1],--n}a!=n&&(e[n]=s)}},je.stbtt__sort_edges_quicksort=function(e,t,n){for(;12<n;){var r,i=n>>1,a=je.STBTT__COMPARE(e[t],e[t+i]),s=je.STBTT__COMPARE(e[t+i],e[t+n-1]);if(a!=s){var l=je.STBTT__COMPARE(e[t],e[t+n-1])==s?0:n-1;r=e[t+l],e[t+l]=e[t+i],e[t+i]=r}r=e[t],e[t]=e[t+i],e[t+i]=r;for(var o=1,u=n-1;;){for(;je.STBTT__COMPARE(e[t+o],e[t]);)++o;for(;je.STBTT__COMPARE(e[t],e[t+u]);)--u;if(u<=o)break;r=e[t+o],e[t+o]=e[t+u],e[t+u]=r,++o,--u}u<n-o?(je.stbtt__sort_edges_quicksort(e,t,u),t+=o,n-=o):(je.stbtt__sort_edges_quicksort(e,t+o,n-o),n=u)}},je.stbtt__sort_edges=function(e,t){je.stbtt__sort_edges_quicksort(e,0,t),je.stbtt__sort_edges_ins_sort(e,t)},je.stbtt__rasterize=function(e,t,n,r,i,a,s,l,o,u,h){for(var c,d=h?-a:a,f=0,_=0,g=r;_<g;){f+=n[_++]}var m=new Array(f+1);if(null!=m){for(var p=0,v=m.length;p<v;){m[p++]=new Se}for(var b=f=0,w=0,x=r;w<x;){var y=w++,k=t,I=0+b;b+=n[y],c=n[y]-1;for(var C=0,B=n[y];C<B;){var T=C++,W=T,S=c;k[I+c].y!=k[I+T].y?(m[f].invert=!1,(h?k[I+c].y>k[I+T].y:k[I+c].y<k[I+T].y)&&(m[f].invert=!0,W=c,S=T),m[f].x0=k[I+W].x*i+s,m[f].y0=1*(k[I+W].y*d+l),m[f].x1=k[I+S].x*i+s,m[f].y1=1*(k[I+S].y*d+l),++f,c=T):c=T}}je.stbtt__sort_edges(m,f),je.stbtt__rasterize_sorted_edges(e,m,f,1,o,u)}},je.stbtt__add_point=function(e,t,n,r){null!=e&&(e[t].x=n,e[t].y=r)},je.stbtt__tesselate_curve=function(e,t,n,r,i,a,s,l,o,u){var h=(n+2*i+s)/4,c=(r+2*a+l)/4,d=(n+s)/2-h,f=(r+l)/2-c;return 16<u||(o<d*d+f*f?(je.stbtt__tesselate_curve(e,t,n,r,(n+i)/2,(r+a)/2,h,c,o,u+1),je.stbtt__tesselate_curve(e,t,h,c,(i+s)/2,(a+l)/2,s,l,o,u+1)):(je.stbtt__add_point(e,t.value,s,l),t.value+=1)),1},je.stbtt_FlattenCurves=function(e,t,n,r,i){for(var a=null,s=0,l=n*n,o=0,u=0,h=0,c=t;h<c;){1==e[h++].type&&++o}if(0==(i.value=o))return null;var d=new Array(o);if(r.value=d,null==r.value)return i.value=0,null;for(var f=0;f<2;){var _=0,g=0;if(1==f++){if(null==(a=new Array(s)))return r.value=null,i.value=0,null;for(var m=0,p=a.length;m<p;){a[m++]=new Le}}o=-1;for(var v=s=0,b=t;v<b;){var w=v++;switch(e[w].type){case 1:0<=o&&(r.value[o]=s-u),++o,u=s,_=e[w].x,g=e[w].y,je.stbtt__add_point(a,s++,_,g);break;case 2:_=e[w].x,g=e[w].y,je.stbtt__add_point(a,s++,_,g);break;case 3:var x={value:s};je.stbtt__tesselate_curve(a,x,_,g,e[w].cx,e[w].cy,e[w].x,e[w].y,l,0),s=x.value,_=e[w].x,g=e[w].y}}r.value[o]=s-u}return a},je.stbtt_Rasterize=function(e,t,n,r,i,a,s,l,o,u,h){var c,d=a<i?a:i,f=0,_={value:f},g=new ye,m=je.stbtt_FlattenCurves(n,r,t/d,g,_);f=_.value,c=g.value,null!=m&&je.stbtt__rasterize(e,m,c,f,i,a,s,l,o,u,h)},je.stbtt_MakeGlyphBitmapSubpixel=function(e,t,n,r,i,a,s,l,o,u,h){var c,d,f=je.stbtt_GetGlyphShape(e,h),_=null==f?0:f.length,g=new We,m=je.stbtt_GetGlyphBitmapBoxSubpixel(e,h,s,l,o,u);c=m.x0,d=m.y0,g.pixels=t,g.pixels_offset=n,g.w=r,g.h=i,g.stride=a,0!=g.w&&0!=g.h&&je.stbtt_Rasterize(g,.35,f,_,s,l,o,u,c,d,!0)},je.stbtt_MakeGlyphBitmap=function(e,t,n,r,i,a,s,l,o){je.stbtt_MakeGlyphBitmapSubpixel(e,t,n,r,i,a,s,l,0,0,o)},je.stbtt_BakeFontBitmap=function(e,t,n,r,i,a,s,l){var o=new Te;if(!je.stbtt_InitFont(o,e,t))return-1;for(var u=0,h=i*a;u<h;){var c=u++;r.writeU8(c,0)}for(var d=1,f=d,_=1,g=je.stbtt_ScaleForPixelHeight(o,n),m=0,p=0;p<s.length;){var v=s[p];++p;var b=je.stbtt_FindGlyphIndex(o,v),w=je.stbtt_GetGlyphHMetrics(o,b),x=w.advanceWidth,y=(w.leftSideBearing,je.stbtt_GetGlyphBitmapBox(o,b,g,g)),k=y.x0,I=y.y0,C=y.x1-k,B=y.y1-I;if(i<=f+C+1&&(d=_,f=1),a<=d+B+1)return-m;if(i<=f+C)throw new ze("Error");if(a<=d+B)throw new ze("Error");je.stbtt_MakeGlyphBitmap(o,r,f+d*i,C,B,i,g,g,b),l[m].x0=f,l[m].y0=d,l[m].x1=f+C,l[m].y1=d+B,l[m].xadvance=g*x,l[m].xoff=k,l[m].yoff=I,f=f+C+1,_<d+B+1&&(_=d+B+1),++m}return _};var Ve=function(){};(r["kha.graphics4.ConstantLocation"]=Ve).__name__=!0;var De=function(e,t,n,r){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=e,this.format=t,this.renderTarget=n,this.depthStencilFormat=r,n&&this.createTexture()};(r["kha.graphics4.CubeMap"]=De).__name__=!0,De.__interfaces__=[b,v],De.prototype={myWidth:null,myHeight:null,format:null,renderTarget:null,depthStencilFormat:null,graphics4:null,frameBuffer:null,texture:null,depthTexture:null,isDepthAttachment:null,createTexture:function(){if(null!=H.gl){if(this.texture=H.gl.createTexture(),H.gl.bindTexture(34067,this.texture),H.gl.texParameteri(34067,10240,9729),H.gl.texParameteri(34067,10241,9729),H.gl.texParameteri(34067,10242,33071),H.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=H.gl.createFramebuffer(),H.gl.bindFramebuffer(36160,this.frameBuffer),this.format){case 0:H.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null);break;case 2:H.gl.texImage2D(34069,0,H.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),H.gl.texImage2D(34070,0,H.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),H.gl.texImage2D(34071,0,H.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),H.gl.texImage2D(34072,0,H.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),H.gl.texImage2D(34073,0,H.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),H.gl.texImage2D(34074,0,H.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null);break;case 3:H.gl.texImage2D(34069,0,H.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),H.gl.texImage2D(34070,0,H.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),H.gl.texImage2D(34071,0,H.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),H.gl.texImage2D(34072,0,H.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),H.gl.texImage2D(34073,0,H.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),H.gl.texImage2D(34074,0,H.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null);break;case 4:H.gl.texImage2D(34069,0,H.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34070,0,H.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34071,0,H.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34072,0,H.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34073,0,H.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34074,0,H.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,H.halfFloat.HALF_FLOAT_OES,null);break;case 5:H.gl.texImage2D(34069,0,H.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),H.gl.texImage2D(34070,0,H.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),H.gl.texImage2D(34071,0,H.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),H.gl.texImage2D(34072,0,H.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),H.gl.texImage2D(34073,0,H.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),H.gl.texImage2D(34074,0,H.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null);break;case 6:H.gl.texImage2D(34069,0,H.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34070,0,H.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34071,0,H.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34072,0,H.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34073,0,H.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,H.halfFloat.HALF_FLOAT_OES,null),H.gl.texImage2D(34074,0,H.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,H.halfFloat.HALF_FLOAT_OES,null);break;default:H.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}if(3==this.format&&(H.gl.texParameteri(34067,10240,9728),H.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!H.gl2)){var e=H.gl.createTexture();H.gl.bindTexture(34067,e),H.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,34069,e,0),H.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,34070,e,0),H.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,34071,e,0),H.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,34072,e,0),H.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,34073,e,0),H.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),H.gl.framebufferTexture2D(36160,36064,34074,e,0),H.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),H.gl.bindFramebuffer(36160,null)}H.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:this.depthTexture=H.gl.createTexture(),H.gl.bindTexture(34067,this.depthTexture),1==e?H.gl.texImage2D(34067,0,H.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):H.gl.texImage2D(34067,0,H.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),H.gl.texParameteri(34067,10240,9728),H.gl.texParameteri(34067,10241,9728),H.gl.texParameteri(34067,10242,33071),H.gl.texParameteri(34067,10243,33071),H.gl.bindFramebuffer(36160,this.frameBuffer),H.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=H.gl.createTexture(),H.gl.bindTexture(34067,this.depthTexture),H.gl.texImage2D(34067,0,H.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,H.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),H.gl.texParameteri(34067,10240,9728),H.gl.texParameteri(34067,10241,9728),H.gl.texParameteri(34067,10242,33071),H.gl.texParameteri(34067,10243,33071),H.gl.bindFramebuffer(36160,this.frameBuffer),H.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g4:function(){return null==this.graphics4&&(this.graphics4=new wt(this)),this.graphics4},__class__:De};var Me=function(e,t){this.sources=[];for(var n=0;n<e.length;){var r=e[n];++n,this.sources.push(r.toString())}this.type=35632,this.shader=null,this.files=t};(r["kha.graphics4.FragmentShader"]=Me).__name__=!0,Me.prototype={sources:null,type:null,shader:null,files:null,__class__:Me};var Ge=function(){};(r["kha.graphics4.GeometryShader"]=Ge).__name__=!0;var Ee=function(){};(r["kha.graphics4.Graphics"]=Ee).__name__=!0,Ee.prototype={begin:null,end:null,clear:null,setVertexBuffer:null,setIndexBuffer:null,setTexture:null,setTextureParameters:null,renderTargetsInvertedY:null,setPipeline:null,setMatrix:null,drawIndexedVertices:null,__class__:Ee};var Fe=function(e){this.pipeline=e,this.projectionLocation=e.getConstantLocation("projectionMatrix"),this.textureLocation=e.getTextureUnit("tex")};(r["kha.graphics4.PipelineCache"]=Fe).__name__=!0,Fe.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:Fe};var Ze=function(e){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=e,Ze.bufferIndex=0,Ze.initShaders(),this.myPipeline=Ze.standardImagePipeline,this.initBuffers()};(r["kha.graphics4.ImageShaderPainter"]=Ze).__name__=!0,Ze.initShaders=function(){if(null==Ze.structure&&(Ze.structure=He.createImageVertexStructure()),null==Ze.standardImagePipeline){var e=He.createImagePipeline(Ze.structure);e.compile(),Ze.standardImagePipeline=new Fe(e)}},Ze.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Ze.rectVertexBuffer){Ze.rectVertexBuffer=new qe(6e3,Ze.structure,1),Ze.rectVertices=Ze.rectVertexBuffer.lock(),Ze.indexBuffer=new Re(9e3,0);for(var e=Ze.indexBuffer.lock(),t=0;t<1500;){var n=t++;e[3*n*2]=4*n,e[3*n*2+1]=4*n+1,e[3*n*2+2]=4*n+2,e[3*n*2+3]=4*n,e[3*n*2+4]=4*n+2,e[3*n*2+5]=4*n+3}Ze.indexBuffer.unlock()}},drawBuffer:function(){Ze.rectVertexBuffer.unlock(4*Ze.bufferIndex),this.g.setVertexBuffer(Ze.rectVertexBuffer),this.g.setIndexBuffer(Ze.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Ze.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ze.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Ze.bufferIndex=0,Ze.rectVertices=Ze.rectVertexBuffer.lock()},end:function(){0<Ze.bufferIndex&&this.drawBuffer(),Ze.lastTexture=null},__class__:Ze};var Ne=function(e){this.myPipeline=null,this.g=e,Ne.bufferIndex=0,Ne.triangleBufferIndex=0,Ne.initShaders(),this.myPipeline=Ne.standardColorPipeline,this.initBuffers()};(r["kha.graphics4.ColoredShaderPainter"]=Ne).__name__=!0,Ne.initShaders=function(){if(null==Ne.structure&&(Ne.structure=He.createColoredVertexStructure()),null==Ne.standardColorPipeline){var e=He.createColoredPipeline(Ne.structure);e.compile(),Ne.standardColorPipeline=new Fe(e)}},Ne.prototype={projectionMatrix:null,g:null,myPipeline:null,setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Ne.rectVertexBuffer){Ne.rectVertexBuffer=new qe(400,Ne.structure,1),Ne.rectVertices=Ne.rectVertexBuffer.lock(),Ne.indexBuffer=new Re(600,0);for(var e=Ne.indexBuffer.lock(),t=0;t<100;){var n=t++;e[3*n*2]=4*n,e[3*n*2+1]=4*n+1,e[3*n*2+2]=4*n+2,e[3*n*2+3]=4*n,e[3*n*2+4]=4*n+2,e[3*n*2+5]=4*n+3}Ne.indexBuffer.unlock(),Ne.triangleVertexBuffer=new qe(300,Ne.structure,1),Ne.triangleVertices=Ne.triangleVertexBuffer.lock(),Ne.triangleIndexBuffer=new Re(300,0);for(var r=Ne.triangleIndexBuffer.lock(),i=0;i<100;){var a=i++;r[3*a]=3*a,r[3*a+1]=3*a+1,r[3*a+2]=3*a+2}Ne.triangleIndexBuffer.unlock()}},setRectVertices:function(e,t,n,r,i,a,s,l){var o=7*Ne.bufferIndex*4;Ne.rectVertices[o]=e,Ne.rectVertices[o+1]=t,Ne.rectVertices[o+2]=-5,Ne.rectVertices[o+7]=n,Ne.rectVertices[o+8]=r,Ne.rectVertices[o+9]=-5,Ne.rectVertices[o+14]=i,Ne.rectVertices[o+15]=a,Ne.rectVertices[o+16]=-5,Ne.rectVertices[o+21]=s,Ne.rectVertices[o+22]=l,Ne.rectVertices[o+23]=-5},setRectColors:function(e,t){var n=7*Ne.bufferIndex*4,r=e*(.00392156862745098*(t>>>24)),i=r*(.00392156862745098*((16711680&t)>>>16)),a=r*(.00392156862745098*((65280&t)>>>8)),s=r*(.00392156862745098*(255&t));Ne.rectVertices[n+3]=i,Ne.rectVertices[n+4]=a,Ne.rectVertices[n+5]=s,Ne.rectVertices[n+6]=r,Ne.rectVertices[n+10]=i,Ne.rectVertices[n+11]=a,Ne.rectVertices[n+12]=s,Ne.rectVertices[n+13]=r,Ne.rectVertices[n+17]=i,Ne.rectVertices[n+18]=a,Ne.rectVertices[n+19]=s,Ne.rectVertices[n+20]=r,Ne.rectVertices[n+24]=i,Ne.rectVertices[n+25]=a,Ne.rectVertices[n+26]=s,Ne.rectVertices[n+27]=r},drawBuffer:function(e){e||0<Ne.triangleBufferIndex&&this.drawTriBuffer(!0),Ne.rectVertexBuffer.unlock(4*Ne.bufferIndex),this.g.setVertexBuffer(Ne.rectVertexBuffer),this.g.setIndexBuffer(Ne.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ne.bufferIndex*3),Ne.bufferIndex=0,Ne.rectVertices=Ne.rectVertexBuffer.lock()},drawTriBuffer:function(e){e||0<Ne.bufferIndex&&this.drawBuffer(!0),Ne.triangleVertexBuffer.unlock(3*Ne.triangleBufferIndex),this.g.setVertexBuffer(Ne.triangleVertexBuffer),this.g.setIndexBuffer(Ne.triangleIndexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Ne.triangleBufferIndex),Ne.triangleBufferIndex=0,Ne.triangleVertices=Ne.triangleVertexBuffer.lock()},fillRect:function(e,t,n,r,i,a,s,l,o,u){0<Ne.triangleBufferIndex&&this.drawTriBuffer(!0),100<=Ne.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(e,t),this.setRectVertices(n,r,i,a,s,l,o,u),++Ne.bufferIndex},__class__:Ne};var Pe=function(e){this.bakedQuadCache=new A,this.bilinear=!1,this.myPipeline=null,this.g=e,Pe.bufferIndex=0,Pe.initShaders(),this.myPipeline=Pe.standardTextPipeline,this.initBuffers()};(r["kha.graphics4.TextShaderPainter"]=Pe).__name__=!0,Pe.initShaders=function(){if(null==Pe.structure&&(Pe.structure=He.createTextVertexStructure()),null==Pe.standardTextPipeline){var e=He.createTextPipeline(Pe.structure);e.compile(),Pe.standardTextPipeline=new Fe(e)}},Pe.findIndex=function(e){we.fontGlyphs;for(var t=L.charBlocks,n=0,r=0,i=t.length/2|0;r<i;){var a=r++,s=t[2*a],l=t[2*a+1];if(s<=e&&e<=l)return n+e-s;n+=l-s+1}return 0},Pe.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Pe.rectVertexBuffer){Pe.rectVertexBuffer=new qe(400,Pe.structure,1),Pe.rectVertices=Pe.rectVertexBuffer.lock(),Pe.indexBuffer=new Re(600,0);for(var e=Pe.indexBuffer.lock(),t=0;t<100;){var n=t++;e[3*n*2]=4*n,e[3*n*2+1]=4*n+1,e[3*n*2+2]=4*n+2,e[3*n*2+3]=4*n,e[3*n*2+4]=4*n+2,e[3*n*2+5]=4*n+3}Pe.indexBuffer.unlock()}},setRectVertices:function(e,t,n,r,i,a,s,l){var o=9*Pe.bufferIndex*4;Pe.rectVertices[o]=e,Pe.rectVertices[o+1]=t,Pe.rectVertices[o+2]=-5,Pe.rectVertices[o+9]=n,Pe.rectVertices[o+10]=r,Pe.rectVertices[o+11]=-5,Pe.rectVertices[o+18]=i,Pe.rectVertices[o+19]=a,Pe.rectVertices[o+20]=-5,Pe.rectVertices[o+27]=s,Pe.rectVertices[o+28]=l,Pe.rectVertices[o+29]=-5},setRectTexCoords:function(e,t,n,r){var i=9*Pe.bufferIndex*4;Pe.rectVertices[i+3]=e,Pe.rectVertices[i+4]=r,Pe.rectVertices[i+12]=e,Pe.rectVertices[i+13]=t,Pe.rectVertices[i+21]=n,Pe.rectVertices[i+22]=t,Pe.rectVertices[i+30]=n,Pe.rectVertices[i+31]=r},setRectColors:function(e,t){var n=9*Pe.bufferIndex*4,r=e*(.00392156862745098*(t>>>24));Pe.rectVertices[n+5]=.00392156862745098*((16711680&t)>>>16),Pe.rectVertices[n+6]=.00392156862745098*((65280&t)>>>8),Pe.rectVertices[n+7]=.00392156862745098*(255&t),Pe.rectVertices[n+8]=r,Pe.rectVertices[n+14]=.00392156862745098*((16711680&t)>>>16),Pe.rectVertices[n+15]=.00392156862745098*((65280&t)>>>8),Pe.rectVertices[n+16]=.00392156862745098*(255&t),Pe.rectVertices[n+17]=r,Pe.rectVertices[n+23]=.00392156862745098*((16711680&t)>>>16),Pe.rectVertices[n+24]=.00392156862745098*((65280&t)>>>8),Pe.rectVertices[n+25]=.00392156862745098*(255&t),Pe.rectVertices[n+26]=r,Pe.rectVertices[n+32]=.00392156862745098*((16711680&t)>>>16),Pe.rectVertices[n+33]=.00392156862745098*((65280&t)>>>8),Pe.rectVertices[n+34]=.00392156862745098*(255&t),Pe.rectVertices[n+35]=r},drawBuffer:function(){Pe.rectVertexBuffer.unlock(4*Pe.bufferIndex),this.g.setVertexBuffer(Pe.rectVertexBuffer),this.g.setIndexBuffer(Pe.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Pe.lastTexture),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*Pe.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Pe.bufferIndex=0,Pe.rectVertices=Pe.rectVertexBuffer.lock()},setFont:function(e){this.font=x.__cast(e,V)},bakedQuadCache:null,drawString:function(e,t,n,r,i,a){var s=this.font._get(this.fontSize),l=s.getTexture();null!=Pe.lastTexture&&l!=Pe.lastTexture&&this.drawBuffer(),Pe.lastTexture=l;for(var o=r,u=i,h=0,c=e.length;h<c;){var d=h++,f=e.charCodeAt(d),_=s.getBakedQuad(this.bakedQuadCache,Pe.findIndex(f),o,u);if(null!=_){100<=Pe.bufferIndex+1&&this.drawBuffer(),this.setRectColors(t,n),this.setRectTexCoords(_.s0*l.get_width()/l.get_realWidth(),_.t0*l.get_height()/l.get_realHeight(),_.s1*l.get_width()/l.get_realWidth(),_.t1*l.get_height()/l.get_realHeight());var g=_.x0,m=_.y1,p=a._02*g+a._12*m+a._22,v=(a._00*g+a._10*m+a._20)/p,b=(a._01*g+a._11*m+a._21)/p,w=_.x0,x=_.y0,y=a._02*w+a._12*x+a._22,k=(a._00*w+a._10*x+a._20)/y,I=(a._01*w+a._11*x+a._21)/y,C=_.x1,B=_.y0,T=a._02*C+a._12*B+a._22,W=(a._00*C+a._10*B+a._20)/T,S=(a._01*C+a._11*B+a._21)/T,A=_.x1,L=_.y1,V=a._02*A+a._12*L+a._22,D=(a._00*A+a._10*L+a._20)/V,M=(a._01*A+a._11*L+a._21)/V;this.setRectVertices(v,b,k,I,W,S,D,M),o+=_.xadvance,++Pe.bufferIndex}}},end:function(){0<Pe.bufferIndex&&this.drawBuffer(),Pe.lastTexture=null},__class__:Pe};var He=function(e){we.call(this),this.set_color(-1),this.canvas=e,this.g=e.get_g4(),this.imagePainter=new Ze(this.g),this.coloredPainter=new Ne(this.g),this.textPainter=new Pe(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new Bt(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==He.videoPipeline&&(He.videoPipeline=He.createImagePipeline(He.createImageVertexStructure()),He.videoPipeline.fragmentShader=he.painter_video_frag,He.videoPipeline.vertexShader=he.painter_video_vert,He.videoPipeline.compile())};(r["kha.graphics4.Graphics2"]=He).__name__=!0,He.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},He.createImageVertexStructure=function(){var e=new tt;return e.add("vertexPosition",2),e.add("texPosition",1),e.add("vertexColor",3),e},He.createImagePipeline=function(e){var t=new Oe;return t.fragmentShader=he.painter_image_frag,t.vertexShader=he.painter_image_vert,t.inputLayout=[e],t.blendSource=1,t.blendDestination=5,t.alphaBlendSource=1,t.alphaBlendDestination=5,t},He.createColoredVertexStructure=function(){var e=new tt;return e.add("vertexPosition",2),e.add("vertexColor",3),e},He.createColoredPipeline=function(e){var t=new Oe;return t.fragmentShader=he.painter_colored_frag,t.vertexShader=he.painter_colored_vert,t.inputLayout=[e],t.blendSource=1,t.blendDestination=5,t.alphaBlendSource=1,t.alphaBlendDestination=5,t},He.createTextVertexStructure=function(){var e=new tt;return e.add("vertexPosition",2),e.add("texPosition",1),e.add("vertexColor",3),e},He.createTextPipeline=function(e){var t=new Oe;return t.fragmentShader=he.painter_text_frag,t.vertexShader=he.painter_text_vert,t.inputLayout=[e],t.blendSource=3,t.blendDestination=5,t.alphaBlendSource=3,t.alphaBlendDestination=5,t},He.__super__=we,He.prototype=a(we.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var e=this.canvas.get_width(),t=this.canvas.get_height();if(this.canvas instanceof W){var n=this.projectionMatrix,r=2/e,i=-e/e,a=2/(0-t),s=-t/(0-t);n._00=r,n._10=0,n._20=0,n._30=i,n._01=0,n._11=a,n._21=0,n._31=s,n._02=0,n._12=0,n._22=-.002000200020002,n._32=-1.0002000200020003,n._03=0,n._13=0,n._23=0,n._33=1}else if(y.get_nonPow2Supported()||(e=He.upperPowerOfTwo(e),t=He.upperPowerOfTwo(t)),this.g.renderTargetsInvertedY()){var l=this.projectionMatrix,o=2/e,u=-e/e,h=2/t,c=-t/t;l._00=o,l._10=0,l._20=0,l._30=u,l._01=0,l._11=h,l._21=0,l._31=c,l._02=0,l._12=0,l._22=-.002000200020002,l._32=-1.0002000200020003,l._03=0,l._13=0,l._23=0,l._33=1}else{var d=this.projectionMatrix,f=2/e,_=-e/e,g=2/(0-t),m=-t/(0-t);d._00=f,d._10=0,d._20=0,d._30=_,d._01=0,d._11=g,d._21=0,d._31=m,d._02=0,d._12=0,d._22=-.002000200020002,d._32=-1.0002000200020003,d._03=0,d._13=0,d._23=0,d._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(e,t,n){var r=this.coloredPainter;0<Ne.triangleBufferIndex&&r.drawTriBuffer(!1),0<Ne.bufferIndex&&r.drawBuffer(!1),this.textPainter.end();var i=t+e.get_width(),a=n+e.get_height(),s=this.transformations[this.transformations.length-1],l=t,o=a,u=s._02*l+s._12*o+s._22,h=(s._00*l+s._10*o+s._20)/u,c=(s._01*l+s._11*o+s._21)/u,d=this.transformations[this.transformations.length-1],f=t,_=n,g=d._02*f+d._12*_+d._22,m=(d._00*f+d._10*_+d._20)/g,p=(d._01*f+d._11*_+d._21)/g,v=this.transformations[this.transformations.length-1],b=i,w=n,x=v._02*b+v._12*w+v._22,y=(v._00*b+v._10*w+v._20)/x,k=(v._01*b+v._11*w+v._21)/x,I=this.transformations[this.transformations.length-1],C=i,B=a,T=I._02*C+I._12*B+I._22,W=(I._00*C+I._10*B+I._20)/T,S=(I._01*C+I._11*B+I._21)/T,A=this.imagePainter,L=this.get_opacity(),V=this.get_color(),D=e;(1500<=Ze.bufferIndex+1||null!=Ze.lastTexture&&D!=Ze.lastTexture)&&A.drawBuffer();var M=.00392156862745098*((16711680&V)>>>16),G=.00392156862745098*((65280&V)>>>8),E=.00392156862745098*(255&V),F=.00392156862745098*(V>>>24)*L,Z=9*Ze.bufferIndex*4;Ze.rectVertices[Z+5]=M,Ze.rectVertices[Z+6]=G,Ze.rectVertices[Z+7]=E,Ze.rectVertices[Z+8]=F,Ze.rectVertices[Z+14]=M,Ze.rectVertices[Z+15]=G,Ze.rectVertices[Z+16]=E,Ze.rectVertices[Z+17]=F,Ze.rectVertices[Z+23]=M,Ze.rectVertices[Z+24]=G,Ze.rectVertices[Z+25]=E,Ze.rectVertices[Z+26]=F,Ze.rectVertices[Z+32]=M,Ze.rectVertices[Z+33]=G,Ze.rectVertices[Z+34]=E,Ze.rectVertices[Z+35]=F;var N=D.get_width()/D.get_realWidth(),P=D.get_height()/D.get_realHeight(),H=9*Ze.bufferIndex*4;Ze.rectVertices[H+3]=0,Ze.rectVertices[H+4]=P,Ze.rectVertices[H+12]=0,Ze.rectVertices[H+13]=0,Ze.rectVertices[H+21]=N,Ze.rectVertices[H+22]=0,Ze.rectVertices[H+30]=N,Ze.rectVertices[H+31]=P;var R=9*Ze.bufferIndex*4;Ze.rectVertices[R]=h,Ze.rectVertices[R+1]=c,Ze.rectVertices[R+2]=-5,Ze.rectVertices[R+9]=m,Ze.rectVertices[R+10]=p,Ze.rectVertices[R+11]=-5,Ze.rectVertices[R+18]=y,Ze.rectVertices[R+19]=k,Ze.rectVertices[R+20]=-5,Ze.rectVertices[R+27]=W,Ze.rectVertices[R+28]=S,Ze.rectVertices[R+29]=-5,++Ze.bufferIndex,Ze.lastTexture=D},drawScaledSubImage:function(e,t,n,r,i,a,s,l,o){var u=this.coloredPainter;0<Ne.triangleBufferIndex&&u.drawTriBuffer(!1),0<Ne.bufferIndex&&u.drawBuffer(!1),this.textPainter.end();var h=this.transformations[this.transformations.length-1],c=a,d=s+o,f=h._02*c+h._12*d+h._22,_=(h._00*c+h._10*d+h._20)/f,g=(h._01*c+h._11*d+h._21)/f,m=this.transformations[this.transformations.length-1],p=a,v=s,b=m._02*p+m._12*v+m._22,w=(m._00*p+m._10*v+m._20)/b,x=(m._01*p+m._11*v+m._21)/b,y=this.transformations[this.transformations.length-1],k=a+l,I=s,C=y._02*k+y._12*I+y._22,B=(y._00*k+y._10*I+y._20)/C,T=(y._01*k+y._11*I+y._21)/C,W=this.transformations[this.transformations.length-1],S=a+l,A=s+o,L=W._02*S+W._12*A+W._22,V=(W._00*S+W._10*A+W._20)/L,D=(W._01*S+W._11*A+W._21)/L,M=this.imagePainter,G=this.get_opacity(),E=this.get_color(),F=e;(1500<=Ze.bufferIndex+1||null!=Ze.lastTexture&&F!=Ze.lastTexture)&&M.drawBuffer();var Z=t/F.get_realWidth(),N=n/F.get_realHeight(),P=(t+r)/F.get_realWidth(),H=(n+i)/F.get_realHeight(),R=9*Ze.bufferIndex*4;Ze.rectVertices[R+3]=Z,Ze.rectVertices[R+4]=H,Ze.rectVertices[R+12]=Z,Ze.rectVertices[R+13]=N,Ze.rectVertices[R+21]=P,Ze.rectVertices[R+22]=N,Ze.rectVertices[R+30]=P,Ze.rectVertices[R+31]=H;var U=.00392156862745098*((16711680&E)>>>16),O=.00392156862745098*((65280&E)>>>8),X=.00392156862745098*(255&E),z=.00392156862745098*(E>>>24)*G,Y=9*Ze.bufferIndex*4;Ze.rectVertices[Y+5]=U,Ze.rectVertices[Y+6]=O,Ze.rectVertices[Y+7]=X,Ze.rectVertices[Y+8]=z,Ze.rectVertices[Y+14]=U,Ze.rectVertices[Y+15]=O,Ze.rectVertices[Y+16]=X,Ze.rectVertices[Y+17]=z,Ze.rectVertices[Y+23]=U,Ze.rectVertices[Y+24]=O,Ze.rectVertices[Y+25]=X,Ze.rectVertices[Y+26]=z,Ze.rectVertices[Y+32]=U,Ze.rectVertices[Y+33]=O,Ze.rectVertices[Y+34]=X,Ze.rectVertices[Y+35]=z;var j=9*Ze.bufferIndex*4;Ze.rectVertices[j]=_,Ze.rectVertices[j+1]=g,Ze.rectVertices[j+2]=-5,Ze.rectVertices[j+9]=w,Ze.rectVertices[j+10]=x,Ze.rectVertices[j+11]=-5,Ze.rectVertices[j+18]=B,Ze.rectVertices[j+19]=T,Ze.rectVertices[j+20]=-5,Ze.rectVertices[j+27]=V,Ze.rectVertices[j+28]=D,Ze.rectVertices[j+29]=-5,++Ze.bufferIndex,Ze.lastTexture=F},get_color:function(){return this.myColor},set_color:function(e){return this.myColor=e},fillRect:function(e,t,n,r){this.imagePainter.end(),this.textPainter.end();var i=this.transformations[this.transformations.length-1],a=e,s=t+r,l=i._02*a+i._12*s+i._22,o=(i._00*a+i._10*s+i._20)/l,u=(i._01*a+i._11*s+i._21)/l,h=this.transformations[this.transformations.length-1],c=e,d=t,f=h._02*c+h._12*d+h._22,_=(h._00*c+h._10*d+h._20)/f,g=(h._01*c+h._11*d+h._21)/f,m=this.transformations[this.transformations.length-1],p=e+n,v=t,b=m._02*p+m._12*v+m._22,w=(m._00*p+m._10*v+m._20)/b,x=(m._01*p+m._11*v+m._21)/b,y=this.transformations[this.transformations.length-1],k=e+n,I=t+r,C=y._02*k+y._12*I+y._22,B=(y._00*k+y._10*I+y._20)/C,T=(y._01*k+y._11*I+y._21)/C;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),o,u,_,g,w,x,B,T)},drawString:function(e,t,n){this.imagePainter.end();var r=this.coloredPainter;0<Ne.triangleBufferIndex&&r.drawTriBuffer(!1),0<Ne.bufferIndex&&r.drawBuffer(!1),this.textPainter.drawString(e,this.get_opacity(),this.get_color(),t,n,this.transformations[this.transformations.length-1])},set_font:function(e){return this.textPainter.setFont(e),this.myFont=e},set_fontSize:function(e){return we.prototype.set_fontSize.call(this,this.textPainter.fontSize=e)},begin:function(e,t){if(null==e&&(e=!0),null!=He.current)throw new ze("End before you begin");(He.current=this).g.begin(),e&&this.clear(t),this.setProjection()},clear:function(e){this.flush(),this.g.clear(null==e?-16777216:e)},flush:function(){this.imagePainter.end(),this.textPainter.end();var e=this.coloredPainter;0<Ne.triangleBufferIndex&&e.drawTriBuffer(!1),0<Ne.bufferIndex&&e.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),He.current!=this)throw new ze("Begin before you end");He.current=null},__class__:He});var Re=function(e,t,n){null==n&&(n=!1),this.usage=t,this.mySize=e,this.buffer=H.gl.createBuffer();var r=new Uint32Array(e);this._data=r};(r["kha.graphics4.IndexBuffer"]=Re).__name__=!0,Re.prototype={buffer:null,_data:null,mySize:null,usage:null,lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e,e+t)},unlock:function(){H.gl.bindBuffer(34963,this.buffer);var e=null==H.elementIndexUint?new Uint16Array(this._data):this._data;H.gl.bufferData(34963,e,1==this.usage?35048:35044)},set:function(){H.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:Re};var Ue=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=Xe.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};(r["kha.graphics4.PipelineStateBase"]=Ue).__name__=!0,Ue.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,conservativeRasterization:null,__class__:Ue};var Oe=function(){this.program=null,Ue.call(this),this.textures=[],this.textureValues=[]};(r["kha.graphics4.PipelineState"]=Oe).__name__=!0,Oe.__super__=Ue,Oe.prototype=a(Ue.prototype,{program:null,textures:null,textureValues:null,compile:function(){null!=this.program&&H.gl.deleteProgram(this.program),this.program=H.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),H.gl.attachShader(this.program,this.vertexShader.shader),H.gl.attachShader(this.program,this.fragmentShader.shader);for(var e=0,t=0,n=this.inputLayout;t<n.length;){var r=n[t];++t;for(var i=0,a=r.elements;i<a.length;){var s=a[i];++i,H.gl.bindAttribLocation(this.program,e,s.name),4==s.data?e+=4:++e}}if(H.gl.linkProgram(this.program),!H.gl.getProgramParameter(this.program,35714))throw new ze("Could not link the shader program:\n"+H.gl.getProgramInfoLog(this.program))},set:function(){H.gl.useProgram(this.program);for(var e=0,t=this.textureValues.length;e<t;){var n=e++;H.gl.uniform1i(this.textureValues[n],n)}H.gl.colorMask(this.colorWriteMasksRed[0],this.colorWriteMasksGreen[0],this.colorWriteMasksBlue[0],this.colorWriteMasksAlpha[0])},compileShader:function(e){if(null==e.shader){for(var t=H.gl.createShader(e.type),n=0!=H.gl.getShaderPrecisionFormat(35632,36338).precision,r=e.files,i=0,a=r.length;i<a;){var s=i++;if(H.gl2){if(0<=r[s].indexOf("-webgl2")||0<=r[s].indexOf("runtime-string")){H.gl.shaderSource(t,e.sources[s]);break}}else{if(!n&&(0<=r[s].indexOf("-relaxed")||0<=r[s].indexOf("runtime-string"))){H.gl.shaderSource(t,e.sources[s]);break}if(n&&(r[s].indexOf("-relaxed")<0||0<=r[s].indexOf("runtime-string"))){H.gl.shaderSource(t,e.sources[s]);break}}}if(H.gl.compileShader(t),!H.gl.getShaderParameter(t,35713))throw new ze("Could not compile shader:\n"+H.gl.getShaderInfoLog(t));e.shader=t}},getConstantLocation:function(e){var t=H.gl.getUniformLocation(this.program,e);null==t&&K.trace("Warning: Uniform "+e+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:92,className:"kha.graphics4.PipelineState",methodName:"getConstantLocation"});for(var n=5126,r=0,i=H.gl.getProgramParameter(this.program,35718);r<i;){var a=r++,s=H.gl.getActiveUniform(this.program,a);if(s.name==e||s.name==e+"[0]"){n=s.type;break}}return new bt(t,n)},getTextureUnit:function(e){var t=this.findTexture(e);if(t<0){var n=H.gl.getUniformLocation(this.program,e);null==n&&K.trace("Warning: Sampler "+e+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:111,className:"kha.graphics4.PipelineState",methodName:"getTextureUnit"}),t=this.textures.length,this.textureValues.push(n),this.textures.push(e)}return new yt(t)},findTexture:function(e){for(var t=0,n=this.textures.length;t<n;){var r=t++;if(this.textures[r]==e)return r}return-1},__class__:Oe});var Xe=w["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:i},Static:(n=function(e){return{_hx_index:1,value:e,__enum__:"kha.graphics4.StencilValue",toString:i}},n.__params__=["value"],n)},Ke=function(){};(r["kha.graphics4.TessellationControlShader"]=Ke).__name__=!0;var Qe=function(){};(r["kha.graphics4.TessellationEvaluationShader"]=Qe).__name__=!0;var Je=function(){};(r["kha.graphics4.TextureUnit"]=Je).__name__=!0;var qe=function(e,t,n,r,i){null==i&&(i=!1),null==r&&(r=0),this.usage=n,this.instanceDataStepRate=r,this.mySize=e;for(var a=this.myStride=0,s=t.elements;a<s.length;){var l=s[a];switch(++a,l.data){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64;break;case 5:this.myStride+=4;break;case 6:this.myStride+=8}}this.buffer=H.gl.createBuffer();var o=new Float32Array(e*this.myStride/4|0);this._data=o,this.sizes=[],this.offsets=[],this.types=[],this.sizes[t.elements.length-1]=0,this.offsets[t.elements.length-1]=0;for(var u=this.types[t.elements.length-1]=0,h=0,c=0,d=t.elements;c<d.length;){var f,_,g=d[c];switch(++c,g.data){case 0:f=1,_=5126;break;case 1:f=2,_=5126;break;case 2:f=3,_=5126;break;case 3:f=4,_=5126;break;case 4:f=16,_=5126;break;case 5:f=2,_=5122;break;case 6:f=4,_=5122}switch(this.sizes[h]=f,this.offsets[h]=u,this.types[h]=_,g.data){case 0:u+=4;break;case 1:u+=8;break;case 2:u+=12;break;case 3:u+=16;break;case 4:u+=64;break;case 5:u+=4;break;case 6:u+=8}++h}};(r["kha.graphics4.VertexBuffer"]=qe).__name__=!0,qe.prototype={buffer:null,_data:null,mySize:null,myStride:null,sizes:null,offsets:null,types:null,usage:null,instanceDataStepRate:null,lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e*this.stride(),(e+t)*this.stride())},unlock:function(e){H.gl.bindBuffer(34962,this.buffer),H.gl.bufferData(34962,this._data,1==this.usage?35048:35044)},stride:function(){return this.myStride},set:function(e){var t=!!H.gl2||H.gl.getExtension("ANGLE_instanced_arrays");H.gl.bindBuffer(34962,this.buffer);for(var n=0,r=0,i=this.sizes.length;r<i;){var a=r++;if(4<this.sizes[a])for(var s=this.sizes[a],l=0;0<s;)H.gl.enableVertexAttribArray(e+n),H.gl.vertexAttribPointer(e+n,4,5126,!1,this.myStride,this.offsets[a]+l),t&&(H.gl2?H.gl.vertexAttribDivisor(e+n,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+n,this.instanceDataStepRate)),s-=4,l+=16,++n;else{var o=5126!=this.types[a];H.gl.enableVertexAttribArray(e+n),H.gl.vertexAttribPointer(e+n,this.sizes[a],this.types[a],o,this.myStride,this.offsets[a]),t&&(H.gl2?H.gl.vertexAttribDivisor(e+n,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+n,this.instanceDataStepRate)),++n}}return n},__class__:qe};var $e=function(e,t){this.name=e,this.data=t};(r["kha.graphics4.VertexElement"]=$e).__name__=!0,$e.prototype={name:null,data:null,__class__:$e};var et=function(e,t){this.sources=[];for(var n=0;n<e.length;){var r=e[n];++n,this.sources.push(r.toString())}this.type=35633,this.shader=null,this.files=t};(r["kha.graphics4.VertexShader"]=et).__name__=!0,et.prototype={sources:null,type:null,shader:null,files:null,__class__:et};var tt=function(){this.elements=[],this.instanced=!1};(r["kha.graphics4.VertexStructure"]=tt).__name__=!0,tt.prototype={elements:null,instanced:null,add:function(e,t){this.elements.push(new $e(e,t))},size:function(){return this.elements.length},get:function(e){return this.elements[e]},__class__:tt};var nt=function(){};(r["kha.graphics5.Graphics"]=nt).__name__=!0;var rt=e.kha.input.Gamepad=function(e,t){null==t&&(t="unknown"),null==e&&(e=0),this.index=e,this.axisListeners=[],this.buttonListeners=[],rt.instances[e]=this};(r["kha.input.Gamepad"]=rt).__name__=!0,rt.get=function(e){return null==e&&(e=0),e>=rt.instances.length?null:rt.instances[e]},rt.notifyOnConnect=function(e,t){null!=e&&rt.connectListeners.push(e),null!=t&&rt.disconnectListeners.push(t)},rt.removeConnect=function(e,t){null!=e&&q.remove(rt.connectListeners,e),null!=t&&q.remove(rt.disconnectListeners,t)},rt.sendConnectEvent=function(e){rt.instances[e].connected=!0;for(var t=0,n=rt.connectListeners;t<n.length;){var r=n[t];++t,r(e)}},rt.sendDisconnectEvent=function(e){rt.instances[e].connected=!1;for(var t=0,n=rt.disconnectListeners;t<n.length;){var r=n[t];++t,r(e)}},rt.prototype={index:null,notify:function(e,t){null!=e&&this.axisListeners.push(e),null!=t&&this.buttonListeners.push(t)},remove:function(e,t){null!=e&&q.remove(this.axisListeners,e),null!=t&&q.remove(this.buttonListeners,t)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return H.getGamepadId(this.index)},sendAxisEvent:function(e,t){for(var n=0,r=this.axisListeners;n<r.length;){var i=r[n];++n,i(e,t)}},sendButtonEvent:function(e,t){for(var n=0,r=this.buttonListeners;n<r.length;){var i=r[n];++n,i(e,t)}},__class__:rt};var it=function(){this.__id=Tt.nextId++,this._inputBuffer=new $(new ArrayBuffer(1))};(r["kha.netsync.Controller"]=it).__name__=!0,it.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},__class__:it};var at=e.kha.input.Keyboard=function(){it.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],at.instance=this};(r["kha.input.Keyboard"]=at).__name__=!0,at.get=function(e){return null==e&&(e=0),H.getKeyboard(e)},at.__super__=it,at.prototype=a(it.prototype,{notify:function(e,t,n){null!=e&&this.downListeners.push(e),null!=t&&this.upListeners.push(t),null!=n&&this.pressListeners.push(n)},remove:function(e,t,n){null!=e&&q.remove(this.downListeners,e),null!=t&&q.remove(this.upListeners,t),null!=n&&q.remove(this.pressListeners,n)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(e){if(null!=Wt.the()){var t=new $(new ArrayBuffer(5));t.setInt32(0,0),t.b[4]=e,Wt.the().sendControllerUpdate(this._id(),t)}for(var n=0,r=this.downListeners;n<r.length;){var i=r[n];++n,i(e)}},sendUpEvent:function(e){if(null!=Wt.the()){var t=new $(new ArrayBuffer(5));t.setInt32(0,1),t.b[4]=e,Wt.the().sendControllerUpdate(this._id(),t)}for(var n=0,r=this.upListeners;n<r.length;){var i=r[n];++n,i(e)}},sendPressEvent:function(e){if(null!=Wt.the()){var t=new $(new ArrayBuffer(5));t.setInt32(0,2),t.b[4]=q.cca(e,0),Wt.the().sendControllerUpdate(this._id(),t)}for(var n=0,r=this.pressListeners;n<r.length;){var i=r[n];++n,i(e)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t);else{var n=e.b[4],r=String.fromCodePoint(n);this.sendPressEvent(r)}else{var i=e.b[4];this.sendUpEvent(i)}else{var a=e.b[4];this.sendDownEvent(a)}},__class__:at});var st=e.kha.input.Mouse=function(){it.call(this),st.instance=this};(r["kha.input.Mouse"]=st).__name__=!0,st.get=function(e){return null==e&&(e=0),H.getMouse(e)},st.__super__=it,st.prototype=a(it.prototype,{notify:function(e,t,n,r,i){this.notifyWindowed(0,e,t,n,r,i)},remove:function(e,t,n,r,i){this.removeWindowed(0,e,t,n,r,i)},notifyWindowed:function(e,t,n,r,i,a){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=n){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(n)}if(null!=r){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(r)}if(null!=i){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=e;)this.windowWheelListeners.push([]);this.windowWheelListeners[e].push(i)}if(null!=a){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=e;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[e].push(a)}},removeWindowed:function(e,t,n,r,i,a){null!=t&&(null!=this.windowDownListeners?e<this.windowDownListeners.length?q.remove(this.windowDownListeners[e],t):K.trace('no downListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):K.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowUpListeners?e<this.windowUpListeners.length?q.remove(this.windowUpListeners[e],n):K.trace('no upListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):K.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowMoveListeners?e<this.windowMoveListeners.length?q.remove(this.windowMoveListeners[e],r):K.trace('no moveListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):K.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowWheelListeners?e<this.windowWheelListeners.length?q.remove(this.windowWheelListeners[e],i):K.trace('no wheelListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):K.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=a&&(null!=this.windowLeaveListeners?e<this.windowLeaveListeners.length?q.remove(this.windowLeaveListeners[e],a):K.trace('no leaveListeners for window "'+e+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):K.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(e,t){},removeFromLockChange:function(e,t){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(e){if(null!=Wt.the()){var t=new $(new ArrayBuffer(8));t.setInt32(0,0),t.setInt32(4,e),Wt.the().sendControllerUpdate(this._id(),t)}if(null!=this.windowLeaveListeners)for(var n=0,r=this.windowLeaveListeners[e];n<r.length;){var i=r[n];++n,i()}},sendDownEvent:function(e,t,n,r){if(null!=Wt.the()){var i=new $(new ArrayBuffer(20));i.setInt32(0,1),i.setInt32(4,e),i.setInt32(8,t),i.setInt32(12,n),i.setInt32(16,r),Wt.the().sendControllerUpdate(this._id(),i)}if(null!=this.windowDownListeners)for(var a=0,s=this.windowDownListeners[e];a<s.length;){var l=s[a];++a,l(t,n,r)}},sendUpEvent:function(e,t,n,r){if(null!=Wt.the()){var i=new $(new ArrayBuffer(20));i.setInt32(0,2),i.setInt32(4,e),i.setInt32(8,t),i.setInt32(12,n),i.setInt32(16,r),Wt.the().sendControllerUpdate(this._id(),i)}if(null!=this.windowUpListeners)for(var a=0,s=this.windowUpListeners[e];a<s.length;){var l=s[a];++a,l(t,n,r)}},sendMoveEvent:function(e,t,n,r,i){if(null!=Wt.the()){var a=new $(new ArrayBuffer(24));a.setInt32(0,3),a.setInt32(4,e),a.setInt32(8,t),a.setInt32(12,n),a.setInt32(16,r),a.setInt32(20,i),Wt.the().sendControllerUpdate(this._id(),a)}if(null!=this.windowMoveListeners)for(var s=0,l=this.windowMoveListeners[e];s<l.length;){var o=l[s];++s,o(t,n,r,i)}},sendWheelEvent:function(e,t){if(null!=Wt.the()){var n=new $(new ArrayBuffer(12));n.setInt32(0,4),n.setInt32(4,e),n.setInt32(8,t),Wt.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowWheelListeners)for(var r=0,i=this.windowWheelListeners[e];r<i.length;){var a=i[r];++r,a(t)}},_receive:function(e){var t=e.getInt32(0);if(0!=t)if(1!=t)if(2!=t)if(3!=t)if(4!=t);else{var n=e.getInt32(4),r=e.getInt32(8);this.sendWheelEvent(n,r)}else{var i=e.getInt32(4),a=e.getInt32(8),s=e.getInt32(12),l=e.getInt32(16),o=e.getInt32(20);this.sendMoveEvent(i,a,s,l,o)}else{var u=e.getInt32(4),h=e.getInt32(8),c=e.getInt32(12),d=e.getInt32(16);this.sendUpEvent(u,h,c,d)}else{var f=e.getInt32(4),_=e.getInt32(8),g=e.getInt32(12),m=e.getInt32(16);this.sendDownEvent(f,_,g,m)}else{var p=e.getInt32(4);this.sendLeaveEvent(p)}},__class__:st});var lt=function(){st.call(this)};(r["kha.input.MouseImpl"]=lt).__name__=!0,lt.__super__=st,lt.prototype=a(st.prototype,{lock:function(){H.lockMouse()},unlock:function(){H.unlockMouse()},canLock:function(){return H.canLockMouse()},isLocked:function(){return H.isMouseLocked()},notifyOnLockChange:function(e,t){H.notifyOfMouseLockChange(e,t)},removeFromLockChange:function(e,t){H.removeFromMouseLockChange(e,t)},hideSystemCursor:function(){H.khanvas.style.cursor="none"},showSystemCursor:function(){H.khanvas.style.cursor="default"},_receive:function(e){e.getInt32(0)},__class__:lt});var ot=e.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],ot.instance=this};(r["kha.input.Surface"]=ot).__name__=!0,ot.get=function(e){return null==e&&(e=0),0!=e?null:ot.instance},ot.prototype={notify:function(e,t,n){null!=e&&this.touchStartListeners.push(e),null!=t&&this.touchEndListeners.push(t),null!=n&&this.moveListeners.push(n)},remove:function(e,t,n){null!=e&&q.remove(this.touchStartListeners,e),null!=t&&q.remove(this.touchEndListeners,t),null!=n&&this.moveListeners.push(n)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(e,t,n){for(var r=0,i=this.touchStartListeners;r<i.length;){var a=i[r];++r,a(e,t,n)}},sendTouchEndEvent:function(e,t,n){for(var r=0,i=this.touchEndListeners;r<i.length;){var a=i[r];++r,a(e,t,n)}},sendMoveEvent:function(e,t,n){for(var r=0,i=this.moveListeners;r<i.length;){var a=i[r];++r,a(e,t,n)}},__class__:ot};var ut=function(e){this.bytes=e};(r["kha.internal.BytesBlob"]=ut).__name__=!0,ut.__interfaces__=[b],ut.fromBytes=function(e){return new ut(e)},ut.alloc=function(e){return new ut(new $(new ArrayBuffer(e)))},ut.prototype={bytes:null,sub:function(e,t){return new ut(this.bytes.sub(e,t))},get_length:function(){return this.bytes.length},writeU8:function(e,t){this.bytes.b[e]=t},readU8:function(e){var t=this.bytes.b[e];return++e,t},toString:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},__class__:ut};var ht=function(){};(r["kha.internal.HdrFormat"]=ht).__name__=!0,ht.readBuf=function(e){for(var t=0;e[t++]=255&ht.buffer[ht.fileOffset],++ht.fileOffset<ht.bufferLength&&t<e.length;);return t},ht.readBufOffset=function(e,t,n){for(var r=0;e[t+r++]=255&ht.buffer[ht.fileOffset],++ht.fileOffset<ht.bufferLength&&r<n;);return r},ht.readPixelsRaw=function(e,t,n,r){var i=4*r,a=ht.readBufOffset(t,n,i);a<i&&K.trace("Error reading raw pixels: got "+a+" bytes, expected "+i,{fileName:"kha/internal/HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},ht.readPixelsRawRLE=function(e,t,n,r,i){var a,s,l,o=new Uint8Array(4),u=null,h=new Uint8Array(2);for(e.length;0<i;){if(ht.readBuf(o)<o.length)return void K.trace("Error reading bytes: expected "+o.length,{fileName:"kha/internal/HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=o[0]||2!=o[1]||0!=(128&o[2]))return t[n++]=255&o[0],t[n++]=255&o[1],t[n++]=255&o[2],t[n++]=255&o[3],void ht.readPixelsRaw(e,t,n,r*i-1);if(((255&o[2])<<8|255&o[3])!=r)return void K.trace("Wrong scanline width "+((255&o[2])<<8|255&o[3])+", expected "+r,{fileName:"kha/internal/HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==u)u=new Uint8Array(4*r);for(var c=a=0;c<4;){for(s=(c+++1)*r;a<s;){if(ht.readBuf(h)<h.length)return void K.trace("Error reading 2-byte buffer",{fileName:"kha/internal/HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(128<(255&h[0])){if(0==(l=(255&h[0])-128)||s-a<l)return void K.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;0<l--;)u[a++]=255&h[1]}else{if(0==(l=255&h[0])||s-a<l)return void K.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(u[a++]=255&h[1],0<--l){if(ht.readBufOffset(u,a,l)<l)return void K.trace("Error reading non-run data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});a+=l}}}}for(var d=0,f=r;d<f;){var _=d++;t[n]=255&u[_],t[n+1]=255&u[_+r],t[n+2]=255&u[_+2*r],t[n+3]=255&u[_+3*r],n+=4}--i}},ht.readLine=function(){for(var e="";;){var t=ht.buffer[ht.fileOffset];if(10==t){++ht.fileOffset;break}if(e+=String.fromCodePoint(t),!(++ht.fileOffset<ht.bufferLength))break}return e},ht.parse=function(e){ht.buffer=p.fromBytes(e),ht.bufferLength=ht.buffer.length;for(var t=ht.fileOffset=0,n=0,r=!1,i=0;i<20;){i++;var a=ht.readLine();if(ht.formatPattern.match(a))r=!0;else if(ht.exposurePattern.match(a))parseFloat(ht.exposurePattern.matched(1));else if(ht.widthHeightPattern.match(a)){n=m.parseInt(ht.widthHeightPattern.matched(1)),t=m.parseInt(ht.widthHeightPattern.matched(2));break}}if(!r)return K.trace("File is not run length encoded!",{fileName:"kha/internal/HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var s=new Uint8Array(t*n*4),l=t,o=n;ht.readPixelsRawRLE(ht.buffer,s,0,l,o);for(var u=new Float32Array(t*n*4),h=0;h<s.length;){var c=s[h]/255,d=s[h+1]/255,f=s[h+2]/255,_=s[h+3],g=Math.pow(2,_-128);c*=g,d*=g,f*=g,u[h]=c,u[h+1]=d,u[h+2]=f,u[h+3]=1,h+=4}return{width:t,height:n,data:u}};var ct=function(e,t){this.stopped=!1,this.element=e,this.looping=t};(r["kha.js.AEAudioChannel"]=ct).__name__=!0,ct.__interfaces__=[z],ct.prototype={element:null,stopped:null,looping:null,play:function(){this.stopped=!1,this.element.play()},get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},set_position:function(e){return this.element.currentTime=e},__class__:ct};var dt=function(){};(r["kha.js.AudioElementAudio"]=dt).__name__=!0,dt.play=function(e,t){return null==t&&(t=!1),dt.stream(e,t)},dt.stream=function(e,t){null==t&&(t=!1),e.element.loop=t;var n=new ct(e.element,t);return n.play(),n};var ft=function(e){this.bakedQuadCache=new A,we.call(this),this.canvas=e,(ft.instance=this).myColor=I.fromBytes(0,0,0)};(r["kha.js.CanvasGraphics"]=ft).__name__=!0,ft.__super__=we,ft.prototype=a(we.prototype,{canvas:null,webfont:null,myColor:null,begin:function(e,t){null==e&&(e=!0),e&&this.clear(t)},clear:function(e){null==e&&(e=0),this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",.00392156862745098*(e>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},drawImage:function(e,t,n){this.canvas.globalAlpha=this.get_opacity(),this.canvas.drawImage(x.__cast(e,k).image,t,n),this.canvas.globalAlpha=1},drawScaledSubImage:function(e,t,n,r,i,a,s,l,o){this.canvas.globalAlpha=this.get_opacity();try{if(l<0||o<0){this.canvas.save(),this.canvas.translate(a,s);var u=0,h=0;l<0&&(this.canvas.scale(-1,1),u=-l),o<0&&(this.canvas.scale(1,-1),h=-o),this.canvas.drawImage(x.__cast(e,k).image,t,n,r,i,u,h,l,o),this.canvas.restore()}else this.canvas.drawImage(x.__cast(e,k).image,t,n,r,i,a,s,l,o)}catch(e){e instanceof ze&&e.val}this.canvas.globalAlpha=1},set_color:function(e){return this.myColor=e,this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",e},fillRect:function(e,t,n,r){var i=this.get_opacity();this.canvas.globalAlpha=i*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(e,t,n,r),this.canvas.globalAlpha=this.get_opacity()},bakedQuadCache:null,drawString:function(e,t,n){var r=this.webfont.getImage(this.get_fontSize(),this.myColor);if(0<r.width)for(var i=t,a=n,s=0,l=e.length;s<l;){var o=s++,u=this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(this.bakedQuadCache,we.fontGlyphs.indexOf(q.cca(e,o)),i,a);null!=u&&(0<u.s1-u.s0&&0<u.t1-u.t0&&0<u.x1-u.x0&&0<u.y1-u.y0&&this.canvas.drawImage(r,u.s0*r.width,u.t0*r.height,(u.s1-u.s0)*r.width,(u.t1-u.t0)*r.height,u.x0,u.y0,u.x1-u.x0,u.y1-u.y0),i+=u.xadvance)}},set_font:function(e){return this.webfont=x.__cast(e,_t),this.webfont},__class__:ft});var _t=function(e){this.images=new ee,this.kravur=new _t.Kravur(e)};(r["kha.js.Font"]=_t).__name__=!0,_t.__interfaces__=[b],_t.prototype={kravur:null,images:null,getImage:function(e,t){var n=1e4*e+we.fontGlyphs.length;if(!this.images.h.hasOwnProperty(n)){var r=this.images,i=new ee;r.h[n]=i}if(this.images.h[n].h.hasOwnProperty(t))return this.images.h[n].h[t];var a=this.kravur._get(e),s=window.document.createElement("canvas");s.width=a.width,s.height=a.height;var l=s.getContext("2d");l.fillStyle="black",l.fillRect(0,0,a.width,a.height);for(var o=l.getImageData(0,0,a.width,a.height),u=x.__cast(a.getTexture(),k).bytes,h=0,c=u.length;h<c;){var d=h++;o.data[4*d]=(16711680&t)>>>16,o.data[4*d+1]=(65280&t)>>>8,o.data[4*d+2]=255&t,o.data[4*d+3]=u.b[d]}l.putImageData(o,0,0);var f=window.document.createElement("img");return f.src=s.toDataURL("image/png"),this.images.h[n].h[t]=f},__class__:_t};var gt=function(){};(r["kha.js.MobileWebAudio"]=gt).__name__=!0,gt._init=function(){try{return void(gt._context=new AudioContext)}catch(e){e instanceof ze&&e.val}try{return void(this._context=new webkitAudioContext)}catch(e){e instanceof ze&&e.val}},gt.play=function(e,t){null==t&&(t=!1);var n=new mt(e,t);return n.play(),n},gt.stream=function(e,t){return null==t&&(t=!1),gt.play(e,t)};var mt=function(e,t){this.stopped=!1,this.paused=!1,this.buffer=e._buffer,this.loop=t,this.createSource()};(r["kha.js.MobileWebAudioChannel"]=mt).__name__=!0,mt.__interfaces__=[z],mt.prototype={buffer:null,loop:null,source:null,gain:null,startTime:null,pauseTime:null,paused:null,stopped:null,createSource:function(){var e=this;this.source=gt._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){e.stopped=!0},this.gain=gt._context.createGain(),this.source.connect(this.gain),this.gain.connect(gt._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=gt._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=gt._context.currentTime,this.source.start())},__class__:mt};var pt=function(e,t,n){var r=this;F.call(this);var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onerror=function(){n({url:e})},i.onload=function(){r.compressedData=$.ofData(i.response),r.uncompressedData=null,gt._context.decodeAudioData(r.compressedData.b.bufferValue,function(e){r._buffer=e,t(r)},function(){n({url:e,error:"Audio format not supported"})})},i.send(null)};(r["kha.js.MobileWebAudioSound"]=pt).__name__=!0,pt.__super__=F,pt.prototype=a(F.prototype,{_buffer:null,uncompress:function(e){e()},__class__:pt});var vt=function(e,t,n){F.call(this),this.done=t,this.failed=n,vt.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var r=0;r<e.length;){var i=e[r];++r,""!=this.element.canPlayType("audio/ogg")&&Y.endsWith(i,".ogg")&&this.filenames.push(i),""!=this.element.canPlayType("audio/mp4")&&Y.endsWith(i,".mp4")&&this.filenames.push(i)}this.element.addEventListener("error",At(this,this.errorListener),!1),this.element.addEventListener("canplay",At(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};(r["kha.js.Sound"]=vt).__name__=!0,vt.__super__=F,vt.prototype=a(F.prototype,{filenames:null,done:null,failed:null,element:null,errorListener:function(e){if(4==this.element.error.code)for(var t=0,n=this.filenames.length-1;t<n;){var r=t++;if(this.element.src==this.filenames[r])return void(this.element.src=this.filenames[r+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",At(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",At(this,this.canPlayThroughListener),!1),this.done(this),q.remove(vt.loading,this)},uncompress:function(e){e()},__class__:vt});var bt=function(e,t){this.value=e,this.type=t};(r["kha.js.graphics4.ConstantLocation"]=bt).__name__=!0,bt.__interfaces__=[Ve],bt.prototype={value:null,type:null,__class__:bt};var wt=function(e){this.matrixCache=new Float32Array(16),this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.currentPipeline=null,this.renderTarget=e,this.init(),H.gl2?this.instancedExtension=!0:(this.instancedExtension=H.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=H.gl.getExtension("EXT_blend_minmax"))};(r["kha.js.graphics4.Graphics"]=wt).__name__=!0,wt.__interfaces__=[Ee],wt.getBlendFunc=function(e){switch(e){case 1:return 1;case 0:case 2:return 0;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},wt.getBlendOp=function(e){switch(e){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},wt.prototype={currentPipeline:null,depthTest:null,depthMask:null,colorMaskRed:null,colorMaskGreen:null,colorMaskBlue:null,colorMaskAlpha:null,indicesCount:null,renderTarget:null,renderTargetFrameBuffer:null,renderTargetTexture:null,isCubeMap:null,isDepthAttachment:null,instancedExtension:null,blendMinMaxExtension:null,init:function(){if(null!=this.renderTarget)if(this.isCubeMap=this.renderTarget instanceof De,this.isCubeMap){var e=x.__cast(this.renderTarget,De);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture,this.isDepthAttachment=e.isDepthAttachment}else{var t=x.__cast(this.renderTarget,U);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture}},begin:function(e){if(H.gl.enable(3042),H.gl.blendFunc(770,771),null==this.renderTarget)H.gl.bindFramebuffer(36160,null),H.gl.viewport(0,0,N.windowWidth(),N.windowHeight());else if(H.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),H.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=e){H.gl.framebufferTexture2D(36160,H.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var t=0,n=e.length;t<n;){var r=t++;H.gl.framebufferTexture2D(36160,H.drawBuffers.COLOR_ATTACHMENT0_WEBGL+r+1,3553,x.__cast(e[r],U).texture,0)}for(var i=[H.drawBuffers.COLOR_ATTACHMENT0_WEBGL],a=0,s=e.length;a<s;){var l=a++;i.push(H.drawBuffers.COLOR_ATTACHMENT0_WEBGL+l+1)}H.gl2?H.gl.drawBuffers(i):H.drawBuffers.drawBuffersWEBGL(i)}},end:function(){},clear:function(e,t,n){var r=0;null!=e&&(r|=16384,H.gl.colorMask(!0,!0,!0,!0),H.gl.clearColor(.00392156862745098*((16711680&e)>>>16),.00392156862745098*((65280&e)>>>8),.00392156862745098*(255&e),.00392156862745098*(e>>>24))),null!=t&&(r|=256,H.gl.enable(2929),H.gl.depthMask(!0),H.gl.clearDepth(t)),null!=n&&(r|=1024,H.gl.enable(2960),H.gl.stencilMask(255),H.gl.clearStencil(n)),H.gl.clear(r),H.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?H.gl.enable(2929):H.gl.disable(2929),H.gl.depthMask(this.depthMask)},renderTargetsInvertedY:function(){return!0},setDepthMode:function(e,t){switch(t){case 0:e?H.gl.enable(2929):H.gl.disable(2929),this.depthTest=e,H.gl.depthFunc(519);break;case 1:H.gl.enable(2929),this.depthTest=!0,H.gl.depthFunc(512);break;case 2:H.gl.enable(2929),this.depthTest=!0,H.gl.depthFunc(514);break;case 3:H.gl.enable(2929),this.depthTest=!0,H.gl.depthFunc(517);break;case 4:H.gl.enable(2929),this.depthTest=!0,H.gl.depthFunc(513);break;case 5:H.gl.enable(2929),this.depthTest=!0,H.gl.depthFunc(515);break;case 6:H.gl.enable(2929),this.depthTest=!0,H.gl.depthFunc(516);break;case 7:H.gl.enable(2929),this.depthTest=!0,H.gl.depthFunc(518)}H.gl.depthMask(e),this.depthMask=e},setBlendingMode:function(e,t,n,r,i,a){1==e&&2==t?H.gl.disable(3042):(H.gl.enable(3042),H.gl.blendFuncSeparate(wt.getBlendFunc(e),wt.getBlendFunc(t),wt.getBlendFunc(r),wt.getBlendFunc(i)),H.gl.blendEquationSeparate(wt.getBlendOp(n),wt.getBlendOp(a)))},setVertexBuffer:function(e){x.__cast(e,qe).set(0)},setIndexBuffer:function(e){this.indicesCount=e.count(),x.__cast(e,Re).set()},setTexture:function(e,t){null==t?(H.gl.activeTexture(33984+x.__cast(e,yt).value),H.gl.bindTexture(3553,null)):x.__cast(t,U).set(x.__cast(e,yt).value)},setTextureParameters:function(e,t,n,r,i,a){switch(H.gl.activeTexture(33984+x.__cast(e,yt).value),t){case 0:H.gl.texParameteri(3553,10242,10497);break;case 1:H.gl.texParameteri(3553,10242,33648);break;case 2:H.gl.texParameteri(3553,10242,33071)}switch(n){case 0:H.gl.texParameteri(3553,10243,10497);break;case 1:H.gl.texParameteri(3553,10243,33648);break;case 2:H.gl.texParameteri(3553,10243,33071)}switch(r){case 0:switch(a){case 0:H.gl.texParameteri(3553,10241,9728);break;case 1:H.gl.texParameteri(3553,10241,9984);break;case 2:H.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(a){case 0:H.gl.texParameteri(3553,10241,9729);break;case 1:H.gl.texParameteri(3553,10241,9985);break;case 2:H.gl.texParameteri(3553,10241,9987)}2==r&&H.gl.texParameteri(3553,H.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(i){case 0:H.gl.texParameteri(3553,10240,9728);break;case 1:case 2:H.gl.texParameteri(3553,10240,9729)}},setCullMode:function(e){switch(e){case 0:H.gl.enable(2884),H.gl.cullFace(1029);break;case 1:H.gl.enable(2884),H.gl.cullFace(1028);break;case 2:H.gl.disable(2884)}},setPipeline:function(e){this.setCullMode(e.cullMode),this.setDepthMode(e.depthWrite,e.depthMode),this.setStencilParameters(e.stencilMode,e.stencilBothPass,e.stencilDepthFail,e.stencilFail,e.stencilReferenceValue,e.stencilReadMask,e.stencilWriteMask),this.setBlendingMode(e.blendSource,e.blendDestination,e.blendOperation,e.alphaBlendSource,e.alphaBlendDestination,e.alphaBlendOperation),(this.currentPipeline=e).set(),this.colorMaskRed=e.colorWriteMasksRed[0],this.colorMaskGreen=e.colorWriteMasksGreen[0],this.colorMaskBlue=e.colorWriteMasksBlue[0],this.colorMaskAlpha=e.colorWriteMasksAlpha[0]},matrixCache:null,setMatrix:function(e,t){this.matrixCache[0]=t._00,this.matrixCache[1]=t._01,this.matrixCache[2]=t._02,this.matrixCache[3]=t._03,this.matrixCache[4]=t._10,this.matrixCache[5]=t._11,this.matrixCache[6]=t._12,this.matrixCache[7]=t._13,this.matrixCache[8]=t._20,this.matrixCache[9]=t._21,this.matrixCache[10]=t._22,this.matrixCache[11]=t._23,this.matrixCache[12]=t._30,this.matrixCache[13]=t._31,this.matrixCache[14]=t._32,this.matrixCache[15]=t._33,H.gl.uniformMatrix4fv(x.__cast(e,bt).value,!1,this.matrixCache)},drawIndexedVertices:function(e,t){null==t&&(t=-1),null==e&&(e=0);var n=null==H.elementIndexUint?5123:5125,r=5123==n?2:4;H.gl.drawElements(4,-1==t?this.indicesCount:t,n,e*r)},convertStencilAction:function(e){switch(e){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},convertCompareMode:function(e){switch(e){case 0:return 519;case 1:return 512;case 2:return 514;case 3:return 517;case 4:return 513;case 5:return 515;case 6:return 516;case 7:return 518}},setStencilParameters:function(e,t,n,r,i,a,s){if(null==s&&(s=255),null==a&&(a=255),0==e&&0==t&&0==n&&0==r)H.gl.disable(2960);else{H.gl.enable(2960);var l=this.convertCompareMode(e);switch(H.gl.stencilMask(s),H.gl.stencilOp(this.convertStencilAction(r),this.convertStencilAction(n),this.convertStencilAction(t)),i._hx_index){case 0:H.gl.stencilFunc(l,0,a);break;case 1:var o=i.value;H.gl.stencilFunc(l,o,a)}}},__class__:wt};var xt=function(e){He.call(this,e)};(r["kha.js.graphics4.Graphics2"]=xt).__name__=!0,xt.__super__=He,xt.prototype=a(He.prototype,{begin:function(e,t){null==e&&(e=!0),H.gl.colorMask(!0,!0,!0,!0),H.gl.disable(2929),H.gl.depthFunc(519),He.prototype.begin.call(this,e,t)},__class__:xt});var yt=function(e){this.value=e};(r["kha.js.graphics4.TextureUnit"]=yt).__name__=!0,yt.__interfaces__=[Je],yt.prototype={value:null,__class__:yt};var kt=function(){};(r["kha.vr.VrInterface"]=kt).__name__=!0,kt.prototype={IsVrEnabled:function(){return!1},__class__:kt};var It=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.vrEnabled=!1,kt.call(this)};(r["kha.js.vr.VrInterface"]=It).__name__=!0,It.__super__=kt,It.prototype=a(kt.prototype,{vrEnabled:null,vrDisplay:null,frameData:null,width:null,height:null,vrWidth:null,vrHeight:null,getVRDisplays:function(){var r=this;navigator.getVRDisplays().then(function(e){if(0<e.length){r.frameData=new VRFrameData,r.vrDisplay=e[0],r.vrDisplay.depthNear=.1,r.vrDisplay.depthFar=1024;var t=r.vrDisplay.getEyeParameters("left"),n=r.vrDisplay.getEyeParameters("right");r.width=H.khanvas.width,r.height=H.khanvas.height,r.vrWidth=2*Math.max(t.renderWidth,n.renderWidth)|0,r.vrHeight=0|Math.max(t.renderHeight,n.renderHeight)}else K.trace("There are no VR displays connected.",{fileName:"kha/js/vr/VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:It});var Ct=function(e,t,n,r,i,a,s,l,o){this._00=e,this._10=t,this._20=n,this._01=r,this._11=i,this._21=a,this._02=s,this._12=l,this._22=o};(r["kha.math.FastMatrix3"]=Ct).__name__=!0,Ct.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:Ct};var Bt=function(e,t,n,r,i,a,s,l,o,u,h,c,d,f,_,g){this._00=e,this._10=t,this._20=n,this._30=r,this._01=i,this._11=a,this._21=s,this._31=l,this._02=o,this._12=u,this._22=h,this._32=c,this._03=d,this._13=f,this._23=_,this._33=g};(r["kha.math.FastMatrix4"]=Bt).__name__=!0,Bt.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:Bt};var Tt=function(){};(r["kha.netsync.ControllerBuilder"]=Tt).__name__=!0;var Wt=function(e,t,n){this.controllers=new ee,(Wt.instance=this).maxPlayers=e,this.address=t,this.port=n};(r["kha.netsync.Session"]=Wt).__name__=!0,Wt.the=function(){return Wt.instance},Wt.prototype={controllers:null,maxPlayers:null,address:null,port:null,sendControllerUpdate:function(e,t){if(this.controllers.h.hasOwnProperty(e)){if(this.controllers.h[e]._inputBuffer.length<this.controllers.h[e]._inputBufferIndex+4+t.length){var n=new $(new ArrayBuffer(this.controllers.h[e]._inputBufferIndex+4+t.length));n.blit(0,this.controllers.h[e]._inputBuffer,0,this.controllers.h[e]._inputBufferIndex),this.controllers.h[e]._inputBuffer=n}this.controllers.h[e]._inputBuffer.setInt32(this.controllers.h[e]._inputBufferIndex,t.length),this.controllers.h[e]._inputBuffer.blit(this.controllers.h[e]._inputBufferIndex+4,t,0,t.length),this.controllers.h[e]._inputBufferIndex+=4+t.length}},__class__:Wt};var St=0;function At(e,t){return null==t?null:(null==t.__id__&&(t.__id__=St++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&(n=t.bind(e),e.hx__closures__[t.__id__]=n),n);var n}r.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55232+(e>>10))+String.fromCharCode(56320+(1023&e))}),String.prototype.__class__=r.String=String,String.__name__=!0,r.Array=Array,Array.__name__=!0,Date.prototype.__class__=r.Date=Date,Date.__name__="Date";var Lt={},Vt={},Dt=Number,Mt=Boolean,Gt={},Et={};ie.count=0;var Ft={};Object.defineProperty(ze.prototype,"message",{get:function(){return String(this.val)}}),null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=g.sliceImpl),re.DEFAULT_RESOLVER=new c,re.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",x.__toStr={}.toString,ue.images=new Q,ue.sounds=new J,ue.blobs=new se,ue.fonts=new le,ue.videos=new oe,I.Black=-16777216,I.White=-1,I.Red=-65536,I.Blue=-16776961,I.Green=-16711936,I.Magenta=-65281,I.Yellow=-256,I.Cyan=-16711681,I.Purple=-8388480,I.Pink=-16181,I.Orange=-23296,I.Transparent=0,I.invMaxChannelValue=.00392156862745098,C.canvas_id="khanvas",B.instance=new B,E.DIF_COUNT=3,E.maxframetime=.5,E.startTime=0,he.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",he.painter_colored_fragData1="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",he.painter_colored_fragData2="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",he.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_colored_vertData1="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_colored_vertData2="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",he.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",he.painter_image_fragData1="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",he.painter_image_fragData2="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",he.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_image_vertData1="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",he.painter_image_vertData2="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",he.painter_text_fragData1="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",he.painter_text_fragData2="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",he.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",he.painter_text_vertData1="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",he.painter_text_vertData2="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",he.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",he.painter_video_fragData1="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",he.painter_video_fragData2="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",he.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",he.painter_video_vertData1="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",he.painter_video_vertData2="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",N.renderListeners=[],N.foregroundListeners=[],N.backgroundListeners=[],N.shutdownListeners=[],H.mobile=!1,H.ios=!1,H.mobileAudioPlaying=!1,H.chrome=!1,H.firefox=!1,H.ie=!1,H.insideInputEvent=!1,H.leftMouseCtrlDown=!1,H.minimumScroll=999,H.lastFirstTouchX=0,H.lastFirstTouchY=0,H.iosSoundEnabled=!1,H.soundEnabled=!1,H.iosTouchs=[],O.windows=[],ce.virtualChannels=[],we.fontGlyphs=function(e){for(var t=[],n=32;n<256;){var r=n++;t.push(r)}return t}(),rt.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},rt.instances=[],rt.connectListeners=[],rt.disconnectListeners=[],at.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},st.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},ht.exposurePattern=new l("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),ht.formatPattern=new l("FORMAT=32-bit_rle_rgbe","i"),ht.widthHeightPattern=new l("-Y ([0-9]+) \\+X ([0-9]+)","i"),vt.loading=[],Tt.nextId=0,u.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);